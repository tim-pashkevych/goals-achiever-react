import{t as Q,d as w,r as d,j as e,S as X,k as Z,m as ee,n as se,p as ae,q as te,v as ne,I as S,a as m,w as _,x as re,y as ie,z as oe,A as ce,R as le,C as de,D as C,E as I,F as B,G as L,H as he,s as q,f as $,o as N,J as ue,K as pe,M as me,O as xe,P as je,Q as ge,T as Se,U as y,e as z,V as fe,W as ve,X as we,Y as ye,Z as ke,_ as be,$ as D,a0 as P,a1 as R,a2 as A,a3 as O,a4 as Ce,a5 as Ie,a6 as Be,a7 as Le,a8 as Ee,a9 as G,aa as _e,ab as $e,ac as Ne,ad as ze,ae as Me,af as W,g as M,ag as Te,B as v,ah as Fe,ai as De,aj as U,ak as Pe,al as H,am as Re,an as Ae,ao as Oe,ap as We,aq as Ue,ar as He,as as b,at as Ve,au as Ke,av as qe,aw as Ge,ax as Je,ay as Ye,az as Qe,aA as Xe,aB as Ze,aC as es,aD as ss,aE as as,aF as ts,aG as ns,i as rs,aH as is,aI as os,aJ as E,aK as cs,aL as ls,aM as V,aN as ds,aO as hs,u as T,aP as us}from"./index-3ecffdea.js";import{u as k}from"./useModal-8055be34.js";import{B as F}from"./Button-128147d0.js";import{b as ps,I as ms}from"./Image-ba34af00.js";import"./index-0e05dea9.js";const xs=Object.keys(Q),js=({setIsOpenPopUp:a,boxRef:t,setIsLoading:s})=>{const r=w();d.useEffect(()=>{const n=o=>{o.target.closest("button")!==t.current&&a(!1)};return document.addEventListener("click",n),()=>{document.removeEventListener("click",n)}},[t,a]),d.useEffect(()=>{const n=o=>{o.code==="Escape"&&a(!1)};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[a]);const i=n=>{s(!0),r(se({theme:n})).unwrap().finally(()=>{a(!1),s(!1)})};return e.jsx(X,{children:xs.map(n=>e.jsx(Z,{children:e.jsxs(ee,{onClick:()=>i(n),children:[" ",n]})},n))})},gs=({setIsLoading:a})=>{const[t,s]=d.useState(!1),r=d.useRef(),i=n=>{n.target.closest("ul")||s(!t)};return e.jsxs(ae,{children:[e.jsxs(te,{onClick:i,ref:r,children:[e.jsx(ne,{children:"Theme"}),!t&&e.jsx(S,{id:"chevron-down",size:16}),t&&e.jsx(S,{id:"chevron-up",size:16})]}),t&&e.jsx(js,{boxRef:r,setIsOpenPopUp:s,setIsLoading:a})]})},Ss=a=>new Promise(t=>{le.imageFileResizer(a,150,150,"JPEG",100,0,s=>{t(s)},"file")}),fs=({setAvatar:a})=>{const{avatarURL:t}=m(_),[s,r]=d.useState(t),i=d.useRef(null),n=()=>{i.current.click()},o=async l=>{const h=new FileReader,u=l.target.files[0];if(a(u),!u)return;const j=await Ss(u);h.onload=g=>{const p=g.target.result;r(p)},h.readAsDataURL(j)};return e.jsxs(re,{children:[e.jsxs(ie,{children:[s&&e.jsx("img",{src:s,alt:"avatar"}),!s&&e.jsx(S,{id:"user",size:48})]}),e.jsxs(oe,{children:[e.jsx(F,{size:"editProfile",type:"button",onClick:n}),e.jsx(ce,{onChange:o,ref:i,type:"file",accept:"image/jpeg,image/png"})]})]})},vs=({register:a,current:t,errors:s})=>{const[r,i]=d.useState(!1),n=()=>{i(!r)};return e.jsxs(de,{children:[e.jsxs(C,{children:[e.jsx(I,{children:e.jsx(B,{...a("name"),defaultValue:t.name,className:s.name?"has-error":"",$hasError:!!s.name})}),s.name&&e.jsx(L,{children:s.name.message})]}),e.jsxs(C,{children:[e.jsx(I,{children:e.jsx(B,{...a("email"),defaultValue:t.email,className:s.email?"has-error":"",$hasError:!!s.email})}),s.email&&e.jsx(L,{children:s.email.message})]}),e.jsxs(C,{children:[e.jsxs(I,{children:[e.jsx(B,{...a("password"),placeholder:"password",className:s.password?"has-error":"",type:r?"text":"password",$hasError:!!s.password}),e.jsx(he,{onClick:n,type:"button",className:r?"active":"",children:r?e.jsx(S,{id:"eye",className:"icon",size:"18"}):e.jsx(S,{id:"eye-off",className:"icon",size:"18"})})]}),s.password&&e.jsx(L,{children:s.password.message})]})]})},ws=({handleCloseModal:a})=>{const[t,s]=d.useState(null),r=m(_),i=m(q),n=w(),{register:o,handleSubmit:l,formState:{errors:h,dirtyFields:u}}=$({mode:"onChange",resolver:N(ue),shouldUnregister:!0}),j=g=>{const{name:p,email:c,password:f}=g;if(!p&&!c&&!f&&!t)return;const x=new FormData;r.name!==p&&p&&x.append("name",p),r.email!==c&&c&&x.append("email",c),f&&x.append("password",f),t&&x.append("avatar",t),n(xe(x)).unwrap().then(()=>{a()})};return e.jsxs(pe,{onSubmit:l(j),children:[e.jsx(me,{children:"Edit profile"}),e.jsx(fs,{setAvatar:s}),e.jsx(vs,{register:o,errors:h,current:r,dirtyFields:u}),e.jsx(F,{title:"Send",icon:!1,isLoading:i})]})},ys=()=>{const{name:a,avatarURL:t}=m(_),[s,r]=k(),i=d.useRef(),n=l=>{l.target.closest("button")===i.current&&r()},o=()=>{r(!1)};return e.jsxs(je,{onClick:n,ref:i,children:[e.jsx(ge,{children:a}),e.jsxs(Se,{children:[t&&e.jsx("img",{src:t,alt:"avatar"}),!t&&e.jsx(S,{id:"user",size:32})]}),s&&e.jsx(y,{toggleModal:o,children:e.jsx(ws,{handleCloseModal:o})})]})},K=["project","star","loading","puzzle-piece","container","lightning","colors","hexagon"],J=({boardId:a,handleCloseModal:t})=>{var p;const s=z(),r=m(fe),i=w(),n=m(c=>ve(c,a)),o=ps.filter(c=>c.themes.includes(r)),{register:l,handleSubmit:h,formState:{errors:u}}=$({resolver:N(Ie),defaultValues:{title:n==null?void 0:n.title,icon:(n==null?void 0:n.icon)||K[0],backgroundImage:(n==null?void 0:n.backgroundImage)||o[0].key},mode:"onChange"}),j={width:28,height:28},g=c=>{a?i(Be({newBoardBody:c,id:a})).unwrap().then(()=>{s(`/home/${c.title}`),t()}):i(Le(c)).unwrap().then(()=>{s(`/home/${c.title}`),t()})};return e.jsx(we,{children:e.jsxs(ye,{onSubmit:h(g),children:[e.jsx(ke,{children:n?"Edit board":"New board"}),e.jsx(be,{type:"text",autoFocus:!0,...l("title"),placeholder:"Title"}),((p=u.title)==null?void 0:p.message)&&e.jsx("div",{children:u.title.message}),e.jsxs(D,{children:[e.jsx(P,{children:"Icons"}),e.jsx(R,{$gap:"11px",children:K.map(c=>e.jsxs(A,{children:[e.jsx(O,{type:"radio",...l("icon"),value:c}),e.jsx(S,{id:c,size:15})]},c))})]}),e.jsxs(D,{children:[e.jsx(P,{children:"Background"}),e.jsx(R,{$width:"252px",$gap:"4px",children:o.map(c=>e.jsxs(A,{children:[e.jsx(O,{type:"radio",...l("backgroundImage"),value:c.key}),e.jsx(ms,{desktop:j,tablet:j,mobile:j,type:"image/png",pathKey:c.key,alt:c.alt,imageCategory:"boardIcons"})]},c.key))})]}),e.jsx(Ce,{children:e.jsx(F,{title:n?"Edit":"Create",icon:!0,size:"large",style:{width:3340}})})]})})},ks=({toggleSidebar:a})=>{const t=m(Ee),s=m(G),[,r]=_e("activeBoardId",s==null?void 0:s._id);return e.jsx($e,{children:t.map(i=>e.jsx(Ls,{icon:i.icon,title:i.title,id:i._id,setActiveBoardId:r,toggleSidebar:a},i._id))})},bs=({toggleModal:a})=>{const t=w(),s=z(),r=m(q),i=()=>{t(Te()).unwrap().then(()=>{s("/"),a(),v.warning("In order to use the application you must log in.")}).catch(()=>{v.error("Sorry, something went wrong. Please try again later.")})};return e.jsxs(Ne,{children:[e.jsx(ze,{children:"Are you sure you want to log out?"}),e.jsxs(Me,{children:[e.jsx(W,{type:"button",onClick:i,disabled:r,children:"Log out"}),e.jsx(W,{type:"button",onClick:()=>a(),children:"Cancel"})]}),r&&e.jsx(M,{})]})},Cs=({toggleModal:a})=>{var l,h;const{register:t,handleSubmit:s,formState:{errors:r,dirtyFields:i}}=$({mode:"onChange",resolver:N(Oe)}),n=w(),o=u=>{n(We(u)).unwrap().then(()=>{a(),v.success("Your request has been successfully sent! Please, check your mail.")}).catch(()=>{v.error("An error occurred. Please try again later.")})};return e.jsx(e.Fragment,{children:e.jsxs(Fe,{onSubmit:s(o),children:[e.jsx(De,{children:"Need help"}),e.jsxs(U,{children:[e.jsx(Pe,{type:"text",name:"email",placeholder:"Email address",...t("email"),$hasError:!!r.email}),((l=r.email)==null?void 0:l.message)&&i&&e.jsxs(H,{children:[r.email.message," "]})]}),e.jsxs(U,{className:"wrapperText",children:[e.jsx(Re,{type:"text",name:"message",placeholder:"Comment",...t("message"),$hasError:!!r.message}),((h=r.message)==null?void 0:h.message)&&i&&e.jsx(H,{children:r.message.message})]}),e.jsx(Ae,{type:"submit",children:"Send"})]})})},Y=({className:a,toggleSidebar:t})=>{const[s,r]=k(),[i,n]=k(),[o,l]=k();return e.jsxs(e.Fragment,{children:[e.jsxs(Ue,{className:a,children:[e.jsxs(He,{to:"/",children:[e.jsx(b,{id:"logo",size:32,className:"logo"}),e.jsx(Ve,{children:"Task Pro"})]}),e.jsx(Ke,{children:"My boards"}),e.jsxs(qe,{children:[e.jsx(Ge,{children:"Create a new board"}),e.jsx(Je,{type:"button",onClick:r,children:e.jsx(b,{id:"plus",size:20,className:"plus"})})]}),e.jsx(Ye,{children:e.jsx(ks,{toggleSidebar:t})}),e.jsxs(Qe,{children:[e.jsxs(Xe,{children:["If you need help with ",e.jsx("span",{children:"TaskPro"}),", check out our support resources or reach out to our customer support team."]}),e.jsxs(Ze,{onClick:n,children:[e.jsx(b,{id:"help-circle",size:20,className:"help-circle"}),"Need help?"]})]}),e.jsx(es,{children:e.jsxs(ss,{type:"button",onClick:l,children:[e.jsx(b,{id:"login",size:32,className:"login"}),"Log out"]})})]}),s&&e.jsx(y,{toggleModal:r,children:e.jsx(J,{handleCloseModal:r})}),i&&e.jsx(y,{toggleModal:n,children:e.jsx(Cs,{toggleModal:n})}),o&&e.jsx(y,{toggleModal:l,children:e.jsx(bs,{toggleModal:l})})]})},Is=({handleBackdropClick:a,toggleSidebar:t})=>(d.useEffect(()=>{const s=r=>{const{code:i}=r;i==="Escape"&&t()};return document.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s)}},[t]),e.jsx(as,{onClick:a,children:e.jsx(Y,{className:"sidebarHeader",toggleSidebar:t})})),Bs=()=>{const[a,t]=d.useState(!1),[s,r]=d.useState(!1),i=d.useCallback(()=>{t(!a)},[a]),n=o=>{o.currentTarget===o.target&&i()};return e.jsxs(ts,{children:[a&&e.jsx(Is,{handleBackdropClick:n,toggleSidebar:i}),e.jsx(ns,{onClick:i,children:e.jsx(S,{id:"menu"})}),e.jsx(gs,{setIsLoading:r}),e.jsx(ys,{}),s&&e.jsx(M,{})]})},Ls=({id:a,title:t,icon:s,setActiveBoardId:r,toggleSidebar:i=!1})=>{const[n,o]=k(),l=w(),h=z(),{boardName:u}=rs(),g=m(G)._id===a,p=f=>{l(ds(a)).unwrap().then(()=>{r(a),h(`/home/${f}`),i&&i()}).catch(x=>v.error(x.message))},c=f=>{l(hs(f)).unwrap().then(()=>{v.success(`The board "${u}" was deleted.`),i&&i()}).catch(x=>{v.error(x.message)})};return e.jsxs(e.Fragment,{children:[e.jsxs(is,{onClick:()=>p(t),$isActive:g,children:[e.jsxs(os,{children:[e.jsx(E,{id:s,size:18,className:"project"}),e.jsx(cs,{children:t})]}),g&&e.jsxs(ls,{children:[e.jsx(V,{type:"button",onClick:o,"aria-label":"edit",children:e.jsx(E,{id:"pencil",size:16,className:"pencil"})}),e.jsx(V,{type:"button",onClick:()=>c(a),"aria-label":"delete",children:e.jsx(E,{id:"trash",size:16,className:"trash"})})]})]}),n&&e.jsx(y,{toggleModal:o,children:e.jsx(J,{boardId:a,handleCloseModal:o})})]})},Es=T.div`
  display: flex;
  flex-direction: row;
`,_s=T.div`
  width: 100%;
  height: 100vh;
  display: flex;
  flex-direction: column;

  @media screen and (min-width: 375px) {
    width: 375px;
  }
  @media screen and (min-width: 768px) {
    width: 768px;
  }
  @media screen and (min-width: 1440px) {
    width: 100%;
  }
`;T.div`
  @media screen and (max-width: 1440px) {
    display: none;
  }
`;const Fs=()=>e.jsxs(Es,{children:[e.jsx(Y,{className:"sidebarHome"}),e.jsxs(_s,{children:[e.jsx(Bs,{}),e.jsx(d.Suspense,{fallback:e.jsx(M,{}),children:e.jsx(us,{})})]})]});export{Fs as default};

import{t as Z,d as k,r as d,j as e,S as ee,k as se,m as ae,n as te,p as ne,q as re,v as ie,I as S,a as x,w as M,x as oe,y as le,z as ce,A as de,R as he,C as ue,D as I,E as B,F as L,G as E,H as pe,s as q,f as _,o as N,J as me,K as xe,M as je,O as ge,P as Se,Q as fe,T as ve,U as v,e as z,V as ye,W as we,X as ke,Y as be,Z as Ce,_ as Ie,$ as Be,a0 as Le,a1 as P,a2 as O,a3 as R,a4 as A,a5 as W,a6 as Ee,a7 as $e,a8 as Me,a9 as _e,aa as Ne,ab as G,ac as ze,ad as Fe,ae as Te,af as De,ag as Pe,ah as U,g as F,ai as Oe,B as w,aj as Re,ak as Ae,al as H,am as We,an as V,ao as Ue,ap as He,aq as Ve,ar as Je,as as Ke,at as qe,au as C,av as Ge,aw as Qe,ax as Ye,ay as Xe,az as Ze,aA as es,aB as ss,aC as as,aD as ts,aE as ns,aF as rs,aG as is,aH as os,aI as ls,i as cs,aJ as ds,aK as hs,aL as $,aM as us,aN as ps,aO as J,aP as ms,aQ as xs,u as T,aR as js}from"./index-49acb368.js";import{u as y,C as gs}from"./ConfirmationPopup-8229bd1a.js";import{B as D}from"./Button-cfe637f3.js";import{b as Ss,I as fs}from"./Image-65e15170.js";import"./index-0e05dea9.js";const vs=Object.keys(Z),ys=({setIsOpenPopUp:n,boxRef:r,setIsLoading:s})=>{const a=k();d.useEffect(()=>{const t=l=>{l.target.closest("button")!==r.current&&n(!1)};return document.addEventListener("click",t),()=>{document.removeEventListener("click",t)}},[r,n]),d.useEffect(()=>{const t=l=>{l.code==="Escape"&&n(!1)};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[n]);const i=t=>{s(!0),a(te({theme:t})).unwrap().finally(()=>{n(!1),s(!1)})};return e.jsx(ee,{children:vs.map(t=>e.jsx(se,{children:e.jsxs(ae,{onClick:()=>i(t),children:[" ",t]})},t))})},ws=({setIsLoading:n})=>{const[r,s]=d.useState(!1),a=d.useRef(),i=t=>{t.target.closest("ul")||s(!r)};return e.jsxs(ne,{children:[e.jsxs(re,{onClick:i,ref:a,children:[e.jsx(ie,{children:"Theme"}),!r&&e.jsx(S,{id:"chevron-down",size:16}),r&&e.jsx(S,{id:"chevron-up",size:16})]}),r&&e.jsx(ys,{boxRef:a,setIsOpenPopUp:s,setIsLoading:n})]})},ks=n=>new Promise(r=>{he.imageFileResizer(n,150,150,"JPEG",100,0,s=>{r(s)},"file")}),bs=({setAvatar:n})=>{const{avatarURL:r}=x(M),[s,a]=d.useState(r),i=d.useRef(null),t=()=>{i.current.click()},l=async c=>{const u=new FileReader,h=c.target.files[0];if(n(h),!h)return;const j=await ks(h);u.onload=m=>{const p=m.target.result;a(p)},u.readAsDataURL(j)};return e.jsxs(oe,{children:[e.jsxs(le,{children:[s&&e.jsx("img",{src:s,alt:"avatar"}),!s&&e.jsx(S,{id:"user",size:48})]}),e.jsxs(ce,{children:[e.jsx(D,{size:"editProfile",type:"button",onClick:t}),e.jsx(de,{onChange:l,ref:i,type:"file",accept:"image/jpeg,image/png"})]})]})},Cs=({register:n,current:r,errors:s})=>{const[a,i]=d.useState(!1),t=()=>{i(!a)};return e.jsxs(ue,{children:[e.jsxs(I,{children:[e.jsx(B,{children:e.jsx(L,{...n("name"),defaultValue:r.name,className:s.name?"has-error":"",$hasError:!!s.name})}),s.name&&e.jsx(E,{children:s.name.message})]}),e.jsxs(I,{children:[e.jsx(B,{children:e.jsx(L,{...n("email"),defaultValue:r.email,className:s.email?"has-error":"",$hasError:!!s.email})}),s.email&&e.jsx(E,{children:s.email.message})]}),e.jsxs(I,{children:[e.jsxs(B,{children:[e.jsx(L,{...n("password"),placeholder:"password",className:s.password?"has-error":"",type:a?"text":"password",$hasError:!!s.password}),e.jsx(pe,{onClick:t,type:"button",className:a?"active":"",children:a?e.jsx(S,{id:"eye",className:"icon",size:"18"}):e.jsx(S,{id:"eye-off",className:"icon",size:"18"})})]}),s.password&&e.jsx(E,{children:s.password.message})]})]})},Is=({handleCloseModal:n})=>{const[r,s]=d.useState(null),a=x(M),i=x(q),t=k(),{register:l,handleSubmit:c,formState:{errors:u,dirtyFields:h}}=_({mode:"onChange",resolver:N(me),shouldUnregister:!0}),j=m=>{const{name:p,email:g,password:o}=m;if(!p&&!g&&!o&&!r)return;const f=new FormData;a.name!==p&&p&&f.append("name",p),a.email!==g&&g&&f.append("email",g),o&&f.append("password",o),r&&f.append("avatar",r),t(ge(f)).unwrap().then(()=>{n()})};return e.jsxs(xe,{onSubmit:c(j),children:[e.jsx(je,{children:"Edit profile"}),e.jsx(bs,{setAvatar:s}),e.jsx(Cs,{register:l,errors:u,current:a,dirtyFields:h}),e.jsx(D,{title:"Send",icon:!1,isLoading:i})]})},Bs=()=>{const{name:n,avatarURL:r}=x(M),[s,a]=y(),i=d.useRef(),t=c=>{c.target.closest("button")===i.current&&a()},l=()=>{a(!1)};return e.jsxs(Se,{onClick:t,ref:i,children:[e.jsx(fe,{children:n}),e.jsxs(ve,{children:[r&&e.jsx("img",{src:r,alt:"avatar"}),!r&&e.jsx(S,{id:"user",size:32})]}),s&&e.jsx(v,{toggleModal:l,children:e.jsx(Is,{handleCloseModal:l})})]})},K=["project","star","loading","puzzle-piece","container","lightning","colors","hexagon"],Q=({boardId:n,handleCloseModal:r})=>{var g;const s=z(),a=x(ye),i=k(),t=x(o=>we(o,n)),l=Ss.filter(o=>o.themes.includes(a)),{register:c,handleSubmit:u,formState:{errors:h,dirtyFields:j}}=_({resolver:N($e),defaultValues:{title:t==null?void 0:t.title,icon:(t==null?void 0:t.icon)||K[0],backgroundImage:(t==null?void 0:t.backgroundImage)||l[0].key},mode:"onChange"}),m={width:28,height:28},p=o=>{n?i(Me({newBoardBody:o,id:n})).unwrap().then(()=>{s(`/home/${o.title}`),r()}):i(_e(o)).unwrap().then(()=>{s(`/home/${o.title}`),r()})};return e.jsx(ke,{children:e.jsxs(be,{onSubmit:u(p),children:[e.jsx(Ce,{children:t?"Edit board":"New board"}),e.jsxs(Ie,{children:[e.jsx(Be,{type:"text",autoFocus:!0,...c("title"),placeholder:"Title",$hasError:!!h.title}),((g=h.title)==null?void 0:g.message)&&j&&e.jsx(Le,{children:h.title.message})]}),e.jsxs(P,{children:[e.jsx(O,{children:"Icons"}),e.jsx(R,{$gap:"11px",children:K.map(o=>e.jsxs(A,{children:[e.jsx(W,{type:"radio",...c("icon"),value:o}),e.jsx(S,{id:o,size:18})]},o))})]}),e.jsxs(P,{children:[e.jsx(O,{children:"Background"}),e.jsx(R,{$width:"252px",$gap:"4px",children:l.map(o=>e.jsxs(A,{children:[e.jsx(W,{type:"radio",...c("backgroundImage"),value:o.key}),e.jsx(fs,{desktop:m,tablet:m,mobile:m,type:"image/png",pathKey:o.key,alt:o.alt,imageCategory:"boardIcons"})]},o.key))})]}),e.jsx(Ee,{children:e.jsx(D,{title:t?"Edit":"Create",icon:!0,size:"large",style:{width:3340}})})]})})},Ls=({toggleSidebar:n})=>{const r=x(Ne),s=x(G),[,a]=ze("activeBoardId",s==null?void 0:s._id);return e.jsx(Fe,{children:r.map(i=>e.jsx(Ns,{icon:i.icon,title:i.title,id:i._id,setActiveBoardId:a,toggleSidebar:n},i._id))})},Es=({toggleModal:n})=>{const r=k(),s=z(),a=x(q),i=()=>{r(Oe()).unwrap().then(()=>{s("/"),n(),w.warning("In order to use the application you must log in.")}).catch(()=>{w.error("Sorry, something went wrong. Please try again later.")})};return e.jsxs(Te,{children:[e.jsx(De,{children:"Are you sure you want to log out?"}),e.jsxs(Pe,{children:[e.jsx(U,{type:"button",onClick:i,disabled:a,children:"Log out"}),e.jsx(U,{type:"button",onClick:()=>n(),children:"Cancel"})]}),a&&e.jsx(F,{})]})},$s=({toggleModal:n})=>{var c,u;const{register:r,handleSubmit:s,formState:{errors:a,dirtyFields:i}}=_({mode:"onChange",resolver:N(Ve)}),t=k(),l=h=>{t(Je(h)).unwrap().then(()=>{n(),w.success("Your request has been successfully sent! Please, check your mail.")}).catch(()=>{w.error("An error occurred. Please try again later.")})};return e.jsx(e.Fragment,{children:e.jsxs(Re,{onSubmit:s(l),children:[e.jsx(Ae,{children:"Need help"}),e.jsxs(H,{children:[e.jsx(We,{type:"text",name:"email",placeholder:"Email address",...r("email"),$hasError:!!a.email}),((c=a.email)==null?void 0:c.message)&&i&&e.jsxs(V,{children:[a.email.message," "]})]}),e.jsxs(H,{className:"wrapperText",children:[e.jsx(Ue,{type:"text",name:"message",placeholder:"Comment",...r("message"),$hasError:!!a.message}),((u=a.message)==null?void 0:u.message)&&i&&e.jsx(V,{children:a.message.message})]}),e.jsx(He,{type:"submit",children:"Send"})]})})},Y=({className:n,toggleSidebar:r})=>{const[s,a]=y(),[i,t]=y(),[l,c]=y();return e.jsxs(e.Fragment,{children:[e.jsxs(Ke,{className:n,children:[e.jsxs(qe,{to:"/",children:[e.jsx(C,{id:"logo",size:32,className:"logo"}),e.jsx(Ge,{children:"Task Pro"})]}),e.jsx(Qe,{children:"My boards"}),e.jsxs(Ye,{children:[e.jsx(Xe,{children:"Create a new board"}),e.jsx(Ze,{type:"button",onClick:a,children:e.jsx(C,{id:"plus",size:20,className:"plus"})})]}),e.jsx(es,{children:e.jsx(Ls,{toggleSidebar:r})}),e.jsxs(ss,{children:[e.jsxs(as,{children:["If you need help with ",e.jsx("span",{children:"TaskPro"}),", check out our support resources or reach out to our customer support team."]}),e.jsxs(ts,{onClick:t,children:[e.jsx(C,{id:"help-circle",size:20,className:"help-circle"}),"Need help?"]})]}),e.jsx(ns,{children:e.jsxs(rs,{type:"button",onClick:c,children:[e.jsx(C,{id:"login",size:32,className:"login"}),"Log out"]})})]}),s&&e.jsx(v,{toggleModal:a,children:e.jsx(Q,{handleCloseModal:a})}),i&&e.jsx(v,{toggleModal:t,children:e.jsx($s,{toggleModal:t})}),l&&e.jsx(v,{toggleModal:c,children:e.jsx(Es,{toggleModal:c})})]})},Ms=({handleBackdropClick:n,toggleSidebar:r})=>(d.useEffect(()=>{const s=a=>{const{code:i}=a;i==="Escape"&&r()};return document.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s)}},[r]),e.jsx(is,{onClick:n,children:e.jsx(Y,{className:"sidebarHeader",toggleSidebar:r})})),_s=()=>{const[n,r]=d.useState(!1),[s,a]=d.useState(!1),i=d.useCallback(()=>{r(!n)},[n]),t=l=>{l.currentTarget===l.target&&i()};return e.jsxs(os,{children:[n&&e.jsx(Ms,{handleBackdropClick:t,toggleSidebar:i}),e.jsx(ls,{onClick:i,children:e.jsx(S,{id:"menu"})}),e.jsx(ws,{setIsLoading:a}),e.jsx(Bs,{}),s&&e.jsx(F,{})]})},Ns=({id:n,title:r,icon:s,toggleSidebar:a=!1})=>{const[i,t]=y(),[l,c]=y(),[u,h]=d.useState(!1),j=k(),m=z(),{boardName:p}=cs(),o=x(G)._id===n,f=b=>{b!==p&&(m(`/home/${b}`),j(ms(n)),a&&a(),localStorage.setItem("activeBoardId",JSON.stringify(n)))},X=()=>{h(!0),j(xs(n)).unwrap().then(()=>{localStorage.removeItem("activeBoardId"),w.success(`The board "${p}" was deleted.`),m("/home"),a&&a()}).catch(b=>{w.error(b.message)}).finally(()=>{h(!1)})};return e.jsxs(e.Fragment,{children:[e.jsxs(ds,{onClick:()=>f(r),$isActive:o,children:[e.jsxs(hs,{children:[e.jsx($,{id:s,size:18,className:"project"}),e.jsx(us,{children:r})]}),o&&e.jsxs(ps,{children:[e.jsx(J,{type:"button",onClick:t,"aria-label":"edit",children:e.jsx($,{id:"pencil",size:16,className:"pencil"})}),e.jsx(J,{type:"button",onClick:c,"aria-label":"delete",children:e.jsx($,{id:"trash",size:16,className:"trash"})})]})]}),i&&e.jsx(v,{toggleModal:t,children:e.jsx(Q,{boardId:n,handleCloseModal:t})}),l&&e.jsx(v,{toggleModal:c,children:e.jsx(gs,{closeModal:c,approveModal:X,isLoading:u,action:`remove ${r} board`})})]})},zs=T.div`
  display: flex;
  flex-direction: row;
`,Fs=T.div`
  width: 100%;
  height: 100vh;
  display: flex;
  flex-direction: column;

  @media screen and (min-width: 375px) {
    width: 375px;
  }
  @media screen and (min-width: 768px) {
    width: 768px;
  }
  @media screen and (min-width: 1440px) {
    width: 100%;
  }
`;T.div`
  @media screen and (max-width: 1440px) {
    display: none;
  }
`;const As=()=>e.jsxs(zs,{children:[e.jsx(Y,{className:"sidebarHome"}),e.jsxs(Fs,{children:[e.jsx(_s,{}),e.jsx(d.Suspense,{fallback:e.jsx(F,{}),children:e.jsx(js,{})})]})]});export{As as default};

import{t as J,d as y,a as p,k as G,r as c,j as e,S as K,m as Y,n as Q,p as X,q as Z,v as ee,w as se,x as ae,I as g,y as B,z as te,A as ne,C as re,D as oe,R as ie,E as le,F as L,G as M,H as I,J as _,K as ce,s as F,f as $,o as P,M as de,O as ue,P as he,Q as pe,T as me,U as xe,V as je,W as f,X as ge,Y as O,Z as Se,_ as fe,$ as ve,a0 as we,a1 as z,a2 as ke,a3 as T,a4 as ye,a5 as be,a6 as Ce,a7 as Le,B as w,e as A,a8 as Me,a9 as Ie,aa as C,ab as _e,ac as Ee,ad as Be,ae as Ne,af as ze,ag as Te,ah as De,ai as Fe,aj as $e,ak as Pe,al as Oe,am as Ae,an as Re,ao as Ue,ap as We,g as R,i as He,aq as Ve,ar as qe,as as E,at as Je,au as Ge,av as D,aw as Ke,ax as Ye,u as N,ay as Qe}from"./index-99fc1da3.js";import{u as v,B as U,C as W}from"./ConfirmationPopup-895e9269.js";import{B as H}from"./Button-32740f5f.js";import"./Image-e53ca638.js";const Xe=Object.keys(J),Ze=({setIsOpenPopUp:n,boxRef:t,setIsLoading:s})=>{const a=y(),r=p(G);c.useEffect(()=>{const o=l=>{l.target.closest("button")!==t.current&&n(!1)};return document.addEventListener("click",o),()=>{document.removeEventListener("click",o)}},[t,n]),c.useEffect(()=>{const o=l=>{l.code==="Escape"&&n(!1)};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[n]);const i=o=>{s(!0),a(Z({theme:o})).unwrap().finally(()=>{n(!1),s(!1)})};return e.jsx(K,{children:Xe.map(o=>e.jsx(Y,{children:e.jsx(Q,{onClick:()=>i(o),children:e.jsx(X,{className:r===o&&"active",children:o})})},o))})},es=({setIsLoading:n})=>{const[t,s]=c.useState(!1),a=c.useRef(),r=i=>{i.target.closest("ul")||s(!t)};return e.jsxs(ee,{children:[e.jsxs(se,{onClick:r,ref:a,children:[e.jsx(ae,{children:"Theme"}),!t&&e.jsx(g,{id:"chevron-down",size:16}),t&&e.jsx(g,{id:"chevron-up",size:16})]}),t&&e.jsx(Ze,{boxRef:a,setIsOpenPopUp:s,setIsLoading:n})]})},ss=n=>new Promise(t=>{ie.imageFileResizer(n,150,150,"JPEG",100,0,s=>{t(s)},"file")}),as=({setAvatar:n})=>{const{avatarURL:t}=p(B),[s,a]=c.useState(t),r=c.useRef(null),i=()=>{r.current.click()},o=async l=>{const d=new FileReader,u=l.target.files[0];if(n(u),!u)return;const m=await ss(u);d.onload=x=>{const h=x.target.result;a(h)},d.readAsDataURL(m)};return e.jsxs(te,{children:[e.jsxs(ne,{children:[s&&e.jsx("img",{src:s,alt:"avatar"}),!s&&e.jsx(g,{id:"user",size:48})]}),e.jsxs(re,{children:[e.jsx(H,{size:"editProfile",type:"button",onClick:i}),e.jsx(oe,{onChange:o,ref:r,type:"file",accept:"image/jpeg,image/png"})]})]})},ts=({register:n,current:t,errors:s})=>{const[a,r]=c.useState(!1),i=()=>{r(!a)};return e.jsxs(le,{children:[e.jsxs(L,{children:[e.jsx(M,{children:e.jsx(I,{...n("name"),defaultValue:t.name,className:s.name?"has-error":"",$hasError:!!s.name})}),s.name&&e.jsx(_,{children:s.name.message})]}),e.jsxs(L,{children:[e.jsx(M,{children:e.jsx(I,{...n("email"),defaultValue:t.email,className:s.email?"has-error":"",$hasError:!!s.email})}),s.email&&e.jsx(_,{children:s.email.message})]}),e.jsxs(L,{children:[e.jsxs(M,{children:[e.jsx(I,{...n("password"),placeholder:"password",className:s.password?"has-error":"",type:a?"text":"password",$hasError:!!s.password}),e.jsx(ce,{onClick:i,type:"button",className:a?"active":"",children:a?e.jsx(g,{id:"eye",className:"icon",size:"18"}):e.jsx(g,{id:"eye-off",className:"icon",size:"18"})})]}),s.password&&e.jsx(_,{children:s.password.message})]})]})},ns=({handleCloseModal:n})=>{const[t,s]=c.useState(null),a=p(B),r=p(F),i=y(),{register:o,handleSubmit:l,formState:{errors:d,dirtyFields:u}}=$({mode:"onChange",resolver:P(de),shouldUnregister:!0}),m=x=>{const{name:h,email:k,password:S}=x;if(!h&&!k&&!S&&!t)return;const j=new FormData;a.name!==h&&h&&j.append("name",h),a.email!==k&&k&&j.append("email",k),S&&j.append("password",S),t&&j.append("avatar",t),i(pe(j)).unwrap().then(()=>{n()})};return e.jsxs(ue,{onSubmit:l(m),children:[e.jsx(he,{children:"Edit  profile"}),e.jsx(as,{setAvatar:s}),e.jsx(ts,{register:o,errors:d,current:a,dirtyFields:u}),e.jsx(H,{title:"Send",icon:!1,isLoading:r})]})},rs=()=>{const{name:n,avatarURL:t}=p(B),[s,a]=v(),r=c.useRef(),i=l=>{l.target.closest("button")===r.current&&a()},o=()=>{a(!1)};return e.jsxs(me,{onClick:i,ref:r,children:[e.jsx(xe,{children:n}),e.jsxs(je,{children:[t&&e.jsx("img",{src:t,alt:"avatar"}),!t&&e.jsx(g,{id:"user",size:32})]}),s&&e.jsx(f,{toggleModal:o,children:e.jsx(ns,{handleCloseModal:o})})]})},os=({toggleSidebar:n})=>{const t=p(ge),s=p(O),[,a]=Se("activeBoardId",s==null?void 0:s._id);return e.jsx(fe,{children:t.map(r=>e.jsx(ds,{icon:r.icon,title:r.title,id:r._id,setActiveBoardId:a,toggleSidebar:n},r._id))})},is=({toggleModal:n})=>{var l,d;const{register:t,handleSubmit:s,formState:{errors:a,dirtyFields:r}}=$({mode:"onChange",resolver:P(Ce)}),i=y(),o=u=>{i(Le(u)).unwrap().then(()=>{n(),w.success("Your request has been successfully sent! Please, check your mail.")}).catch(()=>{w.error("An error occurred. Please try again later.")})};return e.jsx(e.Fragment,{children:e.jsxs(ve,{onSubmit:s(o),children:[e.jsx(we,{children:"Need help"}),e.jsxs(z,{children:[e.jsx(ke,{type:"text",name:"email",placeholder:"Email address",...t("email"),$hasError:!!a.email}),((l=a.email)==null?void 0:l.message)&&r&&e.jsxs(T,{children:[a.email.message," "]})]}),e.jsxs(z,{className:"wrapperText",children:[e.jsx(ye,{type:"text",name:"message",placeholder:"Comment",...t("message"),$hasError:!!a.message}),((d=a.message)==null?void 0:d.message)&&r&&e.jsx(T,{children:a.message.message})]}),e.jsx(be,{type:"submit",children:"Send"})]})})},V=({className:n,toggleSidebar:t})=>{const[s,a]=v(),[r,i]=v(),[o,l]=v(),d=p(F),u=y(),m=A(),x=()=>{u(Ae()).unwrap().then(()=>{m("/"),a(),w.warning("In order to use the application you must log in.")}).catch(()=>{w.error("Sorry, something went wrong. Please try again later.")})};return e.jsxs(e.Fragment,{children:[e.jsxs(Me,{className:n,children:[e.jsxs(Ie,{to:"/",children:[e.jsx(C,{id:"logo",size:32,className:"logo"}),e.jsx(_e,{children:"Task Pro"})]}),e.jsx(Ee,{children:"My boards"}),e.jsxs(Be,{children:[e.jsx(Ne,{children:"Create a new board"}),e.jsx(ze,{type:"button",onClick:a,children:e.jsx(C,{id:"plus",size:20,className:"plus"})})]}),e.jsx(Te,{children:e.jsx(os,{toggleSidebar:t})}),e.jsxs(De,{children:[e.jsxs(Fe,{children:["If you need help with ",e.jsx("span",{children:"TaskPro"}),", check out our support resources or reach out to our customer support team."]}),e.jsxs($e,{onClick:i,children:[e.jsx(C,{id:"help-circle",size:20,className:"help-circle"}),"Need help?"]})]}),e.jsx(Pe,{children:e.jsxs(Oe,{type:"button",onClick:l,children:[e.jsx(C,{id:"login",size:32,className:"login"}),"Log out"]})})]}),s&&e.jsx(f,{toggleModal:a,children:e.jsx(U,{handleCloseModal:a})}),r&&e.jsx(f,{toggleModal:i,children:e.jsx(is,{toggleModal:i})}),o&&e.jsx(f,{toggleModal:l,children:e.jsx(W,{closeModal:l,approveModal:x,logout:!0,action:"log out",isLoading:d})})]})},ls=({handleBackdropClick:n,toggleSidebar:t})=>(c.useEffect(()=>{const s=a=>{const{code:r}=a;r==="Escape"&&t()};return document.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s)}},[t]),e.jsx(Re,{onClick:n,children:e.jsx(V,{className:"sidebarHeader",toggleSidebar:t})})),cs=()=>{const[n,t]=c.useState(!1),[s,a]=c.useState(!1),r=c.useCallback(()=>{t(!n)},[n]),i=o=>{o.currentTarget===o.target&&r()};return e.jsxs(Ue,{children:[n&&e.jsx(ls,{handleBackdropClick:i,toggleSidebar:r}),e.jsx(We,{onClick:r,children:e.jsx(g,{id:"menu"})}),e.jsx(es,{setIsLoading:a}),e.jsx(rs,{}),s&&e.jsx(R,{})]})},ds=({id:n,title:t,icon:s,toggleSidebar:a=!1})=>{const[r,i]=v(),[o,l]=v(),[d,u]=c.useState(!1),m=y(),x=A(),{boardName:h}=He(),S=p(O)._id===n,j=b=>{b!==h&&(x(`/home/${b}`),m(Ke(n)),a&&a(),localStorage.setItem("activeBoardId",JSON.stringify(n)))},q=()=>{u(!0),m(Ye(n)).unwrap().then(()=>{localStorage.removeItem("activeBoardId"),w.success(`The board "${h}" was deleted.`),x("/home"),a&&a()}).catch(b=>{w.error(b.message)}).finally(()=>{u(!1)})};return e.jsxs(e.Fragment,{children:[e.jsxs(Ve,{onClick:()=>j(t),$isActive:S,children:[e.jsxs(qe,{children:[e.jsx(E,{id:s,size:18,className:"project"}),e.jsx(Je,{children:t})]}),S&&e.jsxs(Ge,{children:[e.jsx(D,{type:"button",onClick:i,"aria-label":"edit",children:e.jsx(E,{id:"pencil",size:16,className:"pencil"})}),e.jsx(D,{type:"button",onClick:l,"aria-label":"delete",children:e.jsx(E,{id:"trash",size:16,className:"trash"})})]})]}),r&&e.jsx(f,{toggleModal:i,children:e.jsx(U,{boardId:n,handleCloseModal:i})}),o&&e.jsx(f,{toggleModal:l,children:e.jsx(W,{closeModal:l,approveModal:q,isLoading:d,action:`remove ${t} board`})})]})},us=N.div`
  display: flex;
  flex-direction: row;
`,hs=N.div`
  width: 100%;
  height: 100vh;
  display: flex;
  flex-direction: column;

  @media screen and (min-width: 375px) {
    width: 375px;
  }
  @media screen and (min-width: 768px) {
    width: 768px;
  }
  @media screen and (min-width: 1440px) {
    width: 100%;
  }
`;N.div`
  @media screen and (max-width: 1440px) {
    display: none;
  }
`;const gs=()=>e.jsxs(us,{children:[e.jsx(V,{className:"sidebarHome"}),e.jsxs(hs,{children:[e.jsx(cs,{}),e.jsx(c.Suspense,{fallback:e.jsx(R,{}),children:e.jsx(Qe,{})})]})]});export{gs as default};

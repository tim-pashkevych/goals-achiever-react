import{t as V,d as y,a as p,m as q,r as c,j as e,S as J,n as G,p as K,q as Y,v as Q,w as X,x as Z,y as ee,I as x,z as _,A as se,C as ae,D as te,E as ne,R as re,F as oe,G as C,H as M,J as E,K as I,M as ie,s as D,g as F,o as $,O as le,P as ce,Q as de,T as ue,U as he,V as pe,W as me,X as S,Y as xe,Z as P,_ as je,$ as ge,a0 as Se,a1 as fe,a2 as N,a3 as ve,a4 as z,a5 as we,a6 as be,h as B,a7 as ye,a8 as ke,B as v,f as O,a9 as Ce,aa as Me,ab as k,ac as Ee,ad as Ie,ae as Le,af as _e,ag as Be,ah as Ne,ai as ze,aj as Te,ak as De,al as Fe,am as $e,an as Pe,ao as Oe,ap as Ae,aq as Re,ar as Ue,as as We,at as L,au as He,av as Ve,aw as T,ax as qe,ay as Je,u as A,az as Ge}from"./index-4518ffb4.js";import{B as R}from"./Button-22ef7a58.js";import{u as f,B as U,C as W}from"./ConfirmationPopup-300f27f6.js";import"./Image-4130384f.js";const Ke=Object.keys(V),Ye=({setIsOpenPopUp:a,boxRef:t,setIsLoading:s})=>{const n=y(),r=p(q);c.useEffect(()=>{const o=l=>{l.target.closest("button")!==t.current&&a(!1)};return document.addEventListener("click",o),()=>{document.removeEventListener("click",o)}},[t,a]),c.useEffect(()=>{const o=l=>{l.code==="Escape"&&a(!1)};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[a]);const i=o=>{s(!0),n(Q({theme:o})).unwrap().finally(()=>{a(!1),s(!1)})};return e.jsx(J,{children:Ke.map(o=>e.jsx(G,{children:e.jsx(K,{type:"button",onClick:()=>i(o),children:e.jsx(Y,{className:r===o&&"active",children:o})})},o))})},Qe=({setIsLoading:a})=>{const[t,s]=c.useState(!1),n=c.useRef(),r=i=>{i.target.closest("ul")||s(!t)};return e.jsxs(X,{children:[e.jsxs(Z,{type:"button",onClick:r,ref:n,children:[e.jsx(ee,{children:"Theme"}),!t&&e.jsx(x,{id:"chevron-down",size:16,pointerEvents:"none"}),t&&e.jsx(x,{id:"chevron-up",size:16,pointerEvents:"none"})]}),t&&e.jsx(Ye,{boxRef:n,setIsOpenPopUp:s,setIsLoading:a})]})},Xe=a=>new Promise(t=>{re.imageFileResizer(a,150,150,"JPEG",100,0,s=>{t(s)},"file")}),Ze=({setAvatar:a})=>{const{avatarURL:t}=p(_),[s,n]=c.useState(t),r=c.useRef(null),i=()=>{r.current.click()},o=async l=>{const d=new FileReader,u=l.target.files[0];if(a(u),!u)return;const h=await Xe(u);d.onload=j=>{const m=j.target.result;n(m)},d.readAsDataURL(h)};return e.jsxs(se,{children:[e.jsxs(ae,{children:[s&&e.jsx("img",{src:s,alt:"avatar"}),!s&&e.jsx(x,{id:"user",size:48})]}),e.jsxs(te,{children:[e.jsx(R,{size:"editProfile",type:"button",onClick:i}),e.jsx(ne,{onChange:o,ref:r,type:"file",accept:"image/jpeg,image/png"})]})]})},es=({register:a,current:t,errors:s})=>{const[n,r]=c.useState(!1),i=()=>{r(!n)};return e.jsxs(oe,{children:[e.jsxs(C,{children:[e.jsx(M,{children:e.jsx(E,{...a("name"),defaultValue:t.name,className:s.name?"has-error":"",$hasError:!!s.name})}),s.name&&e.jsx(I,{children:s.name.message})]}),e.jsxs(C,{children:[e.jsx(M,{children:e.jsx(E,{...a("email"),defaultValue:t.email,className:s.email?"has-error":"",$hasError:!!s.email})}),s.email&&e.jsx(I,{children:s.email.message})]}),e.jsxs(C,{children:[e.jsxs(M,{children:[e.jsx(E,{...a("password"),placeholder:"password",className:s.password?"has-error":"",type:n?"text":"password",$hasError:!!s.password}),e.jsx(ie,{onClick:i,type:"button",className:n?"active":"",children:n?e.jsx(x,{id:"eye",className:"icon",size:"18"}):e.jsx(x,{id:"eye-off",className:"icon",size:"18"})})]}),s.password&&e.jsx(I,{children:s.password.message})]})]})},ss=({handleCloseModal:a})=>{const[t,s]=c.useState(null),n=p(_),r=p(D),i=y(),{register:o,handleSubmit:l,formState:{errors:d,dirtyFields:u}}=F({mode:"onChange",resolver:$(le),shouldUnregister:!0}),h=j=>{const{name:m,email:g,password:w}=j;if(!m&&!g&&!w&&!t)return;const b=new FormData;n.name!==m&&m&&b.append("name",m),n.email!==g&&g&&b.append("email",g),w&&b.append("password",w),t&&b.append("avatar",t),i(ue(b)).unwrap().then(()=>{a()})};return e.jsxs(ce,{onSubmit:l(h),children:[e.jsx(de,{children:"Edit  profile"}),e.jsx(Ze,{setAvatar:s}),e.jsx(es,{register:o,errors:d,current:n,dirtyFields:u}),e.jsx(R,{title:"Send",icon:!1,isLoading:r})]})},as=()=>{const{name:a,avatarURL:t}=p(_),[s,n]=f(),r=c.useRef(),i=l=>{l.target.closest("button")===r.current&&n()},o=()=>{n(!1)};return e.jsxs(he,{type:"button",onClick:i,ref:r,children:[e.jsx(pe,{children:a}),e.jsxs(me,{children:[t&&e.jsx("img",{src:t,alt:"avatar"}),!t&&e.jsx(x,{id:"user",size:32})]}),s&&e.jsx(S,{toggleModal:o,children:e.jsx(ss,{handleCloseModal:o})})]})},ts=({toggleSidebar:a})=>{const t=p(xe),s=p(P),[,n]=je("activeBoardId",s==null?void 0:s._id);return e.jsx(ge,{children:t.map(r=>e.jsx(is,{icon:r.icon,title:r.title,id:r._id,setActiveBoardId:n,toggleSidebar:a},r._id))})},ns=({toggleModal:a})=>{var d,u;const t=y(),s=p(D),{register:n,handleSubmit:r,formState:{errors:i,dirtyFields:o}}=F({mode:"onChange",resolver:$(ye)}),l=h=>{t(ke(h)).unwrap().then(()=>{a(),v.success("Your request has been successfully sent! Please, check your mail.")}).catch(()=>{v.error("An error occurred. Please try again later.")})};return e.jsxs(e.Fragment,{children:[e.jsxs(Se,{onSubmit:r(l),children:[e.jsx(fe,{children:"Need help"}),e.jsxs(N,{children:[e.jsx(ve,{type:"text",name:"email",placeholder:"Email address",...n("email"),$hasError:!!i.email}),((d=i.email)==null?void 0:d.message)&&o&&e.jsxs(z,{children:[i.email.message," "]})]}),e.jsxs(N,{className:"wrapperText",children:[e.jsx(we,{type:"text",name:"message",placeholder:"Comment",...n("message"),$hasError:!!i.message}),((u=i.message)==null?void 0:u.message)&&o&&e.jsx(z,{children:i.message.message})]}),e.jsx(be,{type:"submit",children:"Send"})]}),s&&e.jsx(B,{})]})},H=({className:a,toggleSidebar:t})=>{const[s,n]=f(),[r,i]=f(),[o,l]=f(),d=y(),u=O(),h=()=>{d(Pe()).unwrap().then(()=>{u("/"),n(),v.warning("In order to use the application you must log in.")}).catch(()=>{v.error("Sorry, something went wrong. Please try again later.")})};return e.jsxs(e.Fragment,{children:[e.jsxs(Ce,{className:a,children:[e.jsxs(Me,{to:"/",children:[e.jsx(k,{id:"logo",size:32,className:"logo"}),e.jsx(Ee,{children:"Task Pro"})]}),e.jsx(Ie,{children:"My boards"}),e.jsxs(Le,{children:[e.jsx(_e,{children:"Create a new board"}),e.jsx(Be,{type:"button",onClick:n,children:e.jsx(k,{id:"plus",size:20,className:"plus"})})]}),e.jsx(Ne,{children:e.jsx(ts,{toggleSidebar:t})}),e.jsxs(ze,{children:[e.jsxs(Te,{children:["If you need help with ",e.jsx("span",{children:"TaskPro"}),", check out our support resources or reach out to our customer support team."]}),e.jsxs(De,{onClick:i,children:[e.jsx(k,{id:"help-circle",size:20,className:"help-circle"}),"Need help?"]})]}),e.jsx(Fe,{children:e.jsxs($e,{type:"button",onClick:l,children:[e.jsx(k,{id:"login",size:32,className:"login"}),"Log out"]})})]}),s&&e.jsx(S,{toggleModal:n,children:e.jsx(U,{handleCloseModal:n})}),r&&e.jsx(S,{toggleModal:i,children:e.jsx(ns,{toggleModal:i})}),o&&e.jsx(S,{toggleModal:l,children:e.jsx(W,{closeModal:l,approveModal:h,logout:!0,action:"log out"})})]})},rs=({handleBackdropClick:a,toggleSidebar:t})=>(c.useEffect(()=>{const s=n=>{const{code:r}=n;r==="Escape"&&t()};return document.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s)}},[t]),e.jsx(Oe,{onClick:a,children:e.jsx(H,{className:"sidebarHeader",toggleSidebar:t})})),os=()=>{const[a,t]=c.useState(!1),[s,n]=c.useState(!1),r=c.useCallback(()=>{t(!a)},[a]),i=o=>{o.currentTarget===o.target&&r()};return e.jsxs(Ae,{children:[a&&e.jsx(rs,{handleBackdropClick:i,toggleSidebar:r}),e.jsx(Re,{onClick:r,children:e.jsx(x,{id:"menu"})}),e.jsx(Qe,{setIsLoading:n}),e.jsx(as,{}),s&&e.jsx(B,{})]})},is=({id:a,title:t,icon:s,toggleSidebar:n=!1})=>{const[r,i]=f(),[o,l]=f(),d=O(),u=y(),h=p(P),j=h._id===a,m=()=>{a!==h._id&&(d(`/home/${t}`),u(qe(a)),n&&n(),localStorage.setItem("activeBoardId",JSON.stringify(a)))},g=()=>{u(Je(a)).unwrap().then(()=>{localStorage.removeItem("activeBoardId"),v.success(`The board "${a}" was deleted.`),d("/home"),n&&n()}).catch(w=>{v.error(w.message)})};return e.jsxs(e.Fragment,{children:[e.jsxs(Ue,{onClick:()=>m(),$isActive:j,children:[e.jsxs(We,{children:[e.jsx(L,{id:s,size:18,className:"project"}),e.jsx(He,{children:t})]}),j&&e.jsxs(Ve,{children:[e.jsx(T,{type:"button",onClick:i,"aria-label":"edit",children:e.jsx(L,{id:"pencil",size:16,className:"pencil"})}),e.jsx(T,{type:"button",onClick:l,"aria-label":"delete",children:e.jsx(L,{id:"trash",size:16,className:"trash"})})]})]}),r&&e.jsx(S,{toggleModal:i,children:e.jsx(U,{boardId:a,handleCloseModal:i})}),o&&e.jsx(S,{toggleModal:l,children:e.jsx(W,{closeModal:l,approveModal:g,action:`remove ${t} board`})})]})},ls=A.div`
  display: flex;
  flex-direction: row;
`,cs=A.div`
  width: 100vw;
  height: 100vh;
  display: flex;
  flex-direction: column;
`,ms=()=>e.jsxs(ls,{children:[e.jsx(H,{className:"sidebarHome"}),e.jsxs(cs,{children:[e.jsx(os,{}),e.jsx(c.Suspense,{fallback:e.jsx(B,{}),children:e.jsx(Ge,{})})]})]});export{ms as default};

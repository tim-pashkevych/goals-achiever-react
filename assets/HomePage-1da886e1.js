import{t as Q,d as f,r as d,j as e,S as X,k as Z,m as ee,n as se,p as ae,q as te,v as ne,I as j,a as x,w as _,x as re,y as ie,z as oe,A as ce,R as le,C as de,D as C,E as I,F as B,G as L,H as he,s as K,f as $,o as N,J as ue,K as pe,M as me,O as xe,P as je,Q as ge,T as Se,U as w,e as z,V as fe,W as ve,X as ye,Y as we,Z as ke,_ as be,$ as D,a0 as P,a1 as A,a2 as O,a3 as R,a4 as Ce,a5 as Ie,a6 as Be,a7 as Le,a8 as Ee,a9 as q,aa as _e,ab as $e,ac as Ne,ad as ze,ae as Me,af as W,g as M,ag as Te,B as S,ah as Fe,ai as De,aj as U,ak as Pe,al as H,am as Ae,an as Oe,ao as Re,ap as We,aq as Ue,ar as He,as as b,at as Ve,au as Je,av as Ke,aw as qe,ax as Ge,ay as Ye,az as Qe,aA as Xe,aB as Ze,aC as es,aD as ss,aE as as,aF as ts,aG as ns,i as rs,aH as is,aI as os,aJ as E,aK as cs,aL as ls,aM as V,aN as ds,aO as hs,u as T,aP as us}from"./index-c9bc7b2d.js";import{u as k}from"./useModal-ab64e86c.js";import{B as F}from"./Button-cc4b3c3f.js";import{b as ps,I as ms}from"./Image-36b7c753.js";import"./index-0e05dea9.js";const xs=Object.keys(Q),js=({setIsOpenPopUp:n,boxRef:r,setIsLoading:s})=>{const a=f();d.useEffect(()=>{const t=c=>{c.target.closest("button")!==r.current&&n(!1)};return document.addEventListener("click",t),()=>{document.removeEventListener("click",t)}},[r,n]),d.useEffect(()=>{const t=c=>{c.code==="Escape"&&n(!1)};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[n]);const i=t=>{s(!0),a(se({theme:t})).unwrap().finally(()=>{n(!1),s(!1)})};return e.jsx(X,{children:xs.map(t=>e.jsx(Z,{children:e.jsxs(ee,{onClick:()=>i(t),children:[" ",t]})},t))})},gs=({setIsLoading:n})=>{const[r,s]=d.useState(!1),a=d.useRef(),i=t=>{t.target.closest("ul")||s(!r)};return e.jsxs(ae,{children:[e.jsxs(te,{onClick:i,ref:a,children:[e.jsx(ne,{children:"Theme"}),!r&&e.jsx(j,{id:"chevron-down",size:16}),r&&e.jsx(j,{id:"chevron-up",size:16})]}),r&&e.jsx(js,{boxRef:a,setIsOpenPopUp:s,setIsLoading:n})]})},Ss=n=>new Promise(r=>{le.imageFileResizer(n,150,150,"JPEG",100,0,s=>{r(s)},"file")}),fs=({setAvatar:n})=>{const{avatarURL:r}=x(_),[s,a]=d.useState(r),i=d.useRef(null),t=()=>{i.current.click()},c=async l=>{const h=new FileReader,u=l.target.files[0];if(n(u),!u)return;const m=await Ss(u);h.onload=g=>{const p=g.target.result;a(p)},h.readAsDataURL(m)};return e.jsxs(re,{children:[e.jsxs(ie,{children:[s&&e.jsx("img",{src:s,alt:"avatar"}),!s&&e.jsx(j,{id:"user",size:48})]}),e.jsxs(oe,{children:[e.jsx(F,{size:"editProfile",type:"button",onClick:t}),e.jsx(ce,{onChange:c,ref:i,type:"file",accept:"image/jpeg,image/png"})]})]})},vs=({register:n,current:r,errors:s})=>{const[a,i]=d.useState(!1),t=()=>{i(!a)};return e.jsxs(de,{children:[e.jsxs(C,{children:[e.jsx(I,{children:e.jsx(B,{...n("name"),defaultValue:r.name,className:s.name?"has-error":"",$hasError:!!s.name})}),s.name&&e.jsx(L,{children:s.name.message})]}),e.jsxs(C,{children:[e.jsx(I,{children:e.jsx(B,{...n("email"),defaultValue:r.email,className:s.email?"has-error":"",$hasError:!!s.email})}),s.email&&e.jsx(L,{children:s.email.message})]}),e.jsxs(C,{children:[e.jsxs(I,{children:[e.jsx(B,{...n("password"),placeholder:"password",className:s.password?"has-error":"",type:a?"text":"password",$hasError:!!s.password}),e.jsx(he,{onClick:t,type:"button",className:a?"active":"",children:a?e.jsx(j,{id:"eye",className:"icon",size:"18"}):e.jsx(j,{id:"eye-off",className:"icon",size:"18"})})]}),s.password&&e.jsx(L,{children:s.password.message})]})]})},ys=({handleCloseModal:n})=>{const[r,s]=d.useState(null),a=x(_),i=x(K),t=f(),{register:c,handleSubmit:l,formState:{errors:h,dirtyFields:u}}=$({mode:"onChange",resolver:N(ue),shouldUnregister:!0}),m=g=>{const{name:p,email:o,password:v}=g;if(!p&&!o&&!v&&!r)return;const y=new FormData;a.name!==p&&p&&y.append("name",p),a.email!==o&&o&&y.append("email",o),v&&y.append("password",v),r&&y.append("avatar",r),t(xe(y)).unwrap().then(()=>{n()})};return e.jsxs(pe,{onSubmit:l(m),children:[e.jsx(me,{children:"Edit profile"}),e.jsx(fs,{setAvatar:s}),e.jsx(vs,{register:c,errors:h,current:a,dirtyFields:u}),e.jsx(F,{title:"Send",icon:!1,isLoading:i})]})},ws=()=>{const{name:n,avatarURL:r}=x(_),[s,a]=k(),i=d.useRef(),t=l=>{l.target.closest("button")===i.current&&a()},c=()=>{a(!1)};return e.jsxs(je,{onClick:t,ref:i,children:[e.jsx(ge,{children:n}),e.jsxs(Se,{children:[r&&e.jsx("img",{src:r,alt:"avatar"}),!r&&e.jsx(j,{id:"user",size:32})]}),s&&e.jsx(w,{toggleModal:c,children:e.jsx(ys,{handleCloseModal:c})})]})},J=["project","star","loading","puzzle-piece","container","lightning","colors","hexagon"],G=({boardId:n,handleCloseModal:r})=>{var p;const s=z(),a=x(fe),i=f(),t=x(o=>ve(o,n)),c=ps.filter(o=>o.themes.includes(a)),{register:l,handleSubmit:h,formState:{errors:u}}=$({resolver:N(Ie),defaultValues:{title:t==null?void 0:t.title,icon:(t==null?void 0:t.icon)||J[0],backgroundImage:(t==null?void 0:t.backgroundImage)||c[0].key},mode:"onChange"}),m={width:28,height:28},g=o=>{n?i(Be({newBoardBody:o,id:n})).unwrap().then(()=>{s(`/home/${o.title}`),r()}):i(Le(o)).unwrap().then(()=>{s(`/home/${o.title}`),r()})};return e.jsx(ye,{children:e.jsxs(we,{onSubmit:h(g),children:[e.jsx(ke,{children:t?"Edit board":"New board"}),e.jsx(be,{type:"text",autoFocus:!0,...l("title"),placeholder:"Title"}),((p=u.title)==null?void 0:p.message)&&e.jsx("div",{children:u.title.message}),e.jsxs(D,{children:[e.jsx(P,{children:"Icons"}),e.jsx(A,{$gap:"11px",children:J.map(o=>e.jsxs(O,{children:[e.jsx(R,{type:"radio",...l("icon"),value:o}),e.jsx(j,{id:o,size:15})]},o))})]}),e.jsxs(D,{children:[e.jsx(P,{children:"Background"}),e.jsx(A,{$width:"252px",$gap:"4px",children:c.map(o=>e.jsxs(O,{children:[e.jsx(R,{type:"radio",...l("backgroundImage"),value:o.key}),e.jsx(ms,{desktop:m,tablet:m,mobile:m,type:"image/png",pathKey:o.key,alt:o.alt,imageCategory:"boardIcons"})]},o.key))})]}),e.jsx(Ce,{children:e.jsx(F,{title:t?"Edit":"Create",icon:!0,size:"large",style:{width:3340}})})]})})},ks=({toggleSidebar:n})=>{const r=x(Ee),s=x(q),[,a]=_e("activeBoardId",s==null?void 0:s._id);return e.jsx($e,{children:r.map(i=>e.jsx(Ls,{icon:i.icon,title:i.title,id:i._id,setActiveBoardId:a,toggleSidebar:n},i._id))})},bs=({toggleModal:n})=>{const r=f(),s=z(),a=x(K),i=()=>{r(Te()).unwrap().then(()=>{s("/"),n(),S.warning("In order to use the application you must log in.")}).catch(()=>{S.error("Sorry, something went wrong. Please try again later.")})};return e.jsxs(Ne,{children:[e.jsx(ze,{children:"Are you sure you want to log out?"}),e.jsxs(Me,{children:[e.jsx(W,{type:"button",onClick:i,disabled:a,children:"Log out"}),e.jsx(W,{type:"button",onClick:()=>n(),children:"Cancel"})]}),a&&e.jsx(M,{})]})},Cs=({toggleModal:n})=>{var l,h;const{register:r,handleSubmit:s,formState:{errors:a,dirtyFields:i}}=$({mode:"onChange",resolver:N(Re)}),t=f(),c=u=>{t(We(u)).unwrap().then(()=>{n(),S.success("Your request has been successfully sent! Please, check your mail.")}).catch(()=>{S.error("An error occurred. Please try again later.")})};return e.jsx(e.Fragment,{children:e.jsxs(Fe,{onSubmit:s(c),children:[e.jsx(De,{children:"Need help"}),e.jsxs(U,{children:[e.jsx(Pe,{type:"text",name:"email",placeholder:"Email address",...r("email"),$hasError:!!a.email}),((l=a.email)==null?void 0:l.message)&&i&&e.jsxs(H,{children:[a.email.message," "]})]}),e.jsxs(U,{className:"wrapperText",children:[e.jsx(Ae,{type:"text",name:"message",placeholder:"Comment",...r("message"),$hasError:!!a.message}),((h=a.message)==null?void 0:h.message)&&i&&e.jsx(H,{children:a.message.message})]}),e.jsx(Oe,{type:"submit",children:"Send"})]})})},Y=({className:n,toggleSidebar:r})=>{const[s,a]=k(),[i,t]=k(),[c,l]=k();return e.jsxs(e.Fragment,{children:[e.jsxs(Ue,{className:n,children:[e.jsxs(He,{to:"/",children:[e.jsx(b,{id:"logo",size:32,className:"logo"}),e.jsx(Ve,{children:"Task Pro"})]}),e.jsx(Je,{children:"My boards"}),e.jsxs(Ke,{children:[e.jsx(qe,{children:"Create a new board"}),e.jsx(Ge,{type:"button",onClick:a,children:e.jsx(b,{id:"plus",size:20,className:"plus"})})]}),e.jsx(Ye,{children:e.jsx(ks,{toggleSidebar:r})}),e.jsxs(Qe,{children:[e.jsxs(Xe,{children:["If you need help with ",e.jsx("span",{children:"TaskPro"}),", check out our support resources or reach out to our customer support team."]}),e.jsxs(Ze,{onClick:t,children:[e.jsx(b,{id:"help-circle",size:20,className:"help-circle"}),"Need help?"]})]}),e.jsx(es,{children:e.jsxs(ss,{type:"button",onClick:l,children:[e.jsx(b,{id:"login",size:32,className:"login"}),"Log out"]})})]}),s&&e.jsx(w,{toggleModal:a,children:e.jsx(G,{handleCloseModal:a})}),i&&e.jsx(w,{toggleModal:t,children:e.jsx(Cs,{toggleModal:t})}),c&&e.jsx(w,{toggleModal:l,children:e.jsx(bs,{toggleModal:l})})]})},Is=({handleBackdropClick:n,toggleSidebar:r})=>(d.useEffect(()=>{const s=a=>{const{code:i}=a;i==="Escape"&&r()};return document.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s)}},[r]),e.jsx(as,{onClick:n,children:e.jsx(Y,{className:"sidebarHeader",toggleSidebar:r})})),Bs=()=>{const[n,r]=d.useState(!1),[s,a]=d.useState(!1),i=d.useCallback(()=>{r(!n)},[n]),t=c=>{c.currentTarget===c.target&&i()};return e.jsxs(ts,{children:[n&&e.jsx(Is,{handleBackdropClick:t,toggleSidebar:i}),e.jsx(ns,{onClick:i,children:e.jsx(j,{id:"menu"})}),e.jsx(gs,{setIsLoading:a}),e.jsx(ws,{}),s&&e.jsx(M,{})]})},Ls=({id:n,title:r,icon:s,toggleSidebar:a=!1})=>{const[i,t]=k(),c=f(),l=z(),{boardName:h}=rs(),m=x(q)._id===n,g=o=>{o!==h&&(l(`/home/${o}`),c(ds(n)),a&&a(),localStorage.setItem("activeBoardId",JSON.stringify(n)))},p=o=>{c(hs(o)).unwrap().then(()=>{localStorage.removeItem("activeBoardId"),S.success(`The board "${h}" was deleted.`),l("/home"),a&&a()}).catch(v=>{S.error(v.message)})};return e.jsxs(e.Fragment,{children:[e.jsxs(is,{onClick:()=>g(r),$isActive:m,children:[e.jsxs(os,{children:[e.jsx(E,{id:s,size:18,className:"project"}),e.jsx(cs,{children:r})]}),m&&e.jsxs(ls,{children:[e.jsx(V,{type:"button",onClick:t,"aria-label":"edit",children:e.jsx(E,{id:"pencil",size:16,className:"pencil"})}),e.jsx(V,{type:"button",onClick:()=>p(n),"aria-label":"delete",children:e.jsx(E,{id:"trash",size:16,className:"trash"})})]})]}),i&&e.jsx(w,{toggleModal:t,children:e.jsx(G,{boardId:n,handleCloseModal:t})})]})},Es=T.div`
  display: flex;
  flex-direction: row;
`,_s=T.div`
  width: 100%;
  height: 100vh;
  display: flex;
  flex-direction: column;

  @media screen and (min-width: 375px) {
    width: 375px;
  }
  @media screen and (min-width: 768px) {
    width: 768px;
  }
  @media screen and (min-width: 1440px) {
    width: 100%;
  }
`;T.div`
  @media screen and (max-width: 1440px) {
    display: none;
  }
`;const Fs=()=>e.jsxs(Es,{children:[e.jsx(Y,{className:"sidebarHome"}),e.jsxs(_s,{children:[e.jsx(Bs,{}),e.jsx(d.Suspense,{fallback:e.jsx(M,{}),children:e.jsx(us,{})})]})]});export{Fs as default};

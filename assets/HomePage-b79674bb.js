import{t as K,b as f,r as l,j as e,S as q,f as G,g as J,h as Y,i as Q,k as X,m as Z,I as g,n as m,s as ee,o as se,p as ae,q as te,v as ne,w as re,x as M,y as T,z as $,A as F,C as N,D as oe,E as ie,F as ce,G as le,H as de,J as ue,K as O,M as he,O as pe,P as xe,Q as D,R as me,B as S,T as je,U as ge,V as Se,W as P,X as fe,Y as R,Z as ve,_ as be,$ as ke,a0 as ye,a1 as we,a2 as Ce,a3 as y,a4 as Ie,a5 as Be,a6 as Le,a7 as Ee,a8 as _e,a9 as ze,aa as Me,ab as Te,ac as $e,ad as Fe,ae as Ne,af as b,ag as B,ah as De,ai as Pe,aj as Re,ak as Ae,al as Oe,am as We,an as w,ao as C,ap as He,aq as Ue,ar as Ve,as as Ke,at as qe,au as Ge,av as Je,aw as Ye,ax as Qe,ay as Xe,az as Ze,aA as es,aB as W,e as ss,aC as as,aD as ts,aE as ns,aF as rs,aG as I,aH as os,aI as is,aJ as A,aK as cs,aL as ls,u as L,aM as ds}from"./index-12478116.js";import{u as k}from"./useModal-3ef96537.js";import{u as E,o as _,B as z}from"./yup-3e54d75a.js";import{b as us,I as hs}from"./Image-dafeffbb.js";const ps=Object.keys(K),xs=({setIsOpenPopUp:a,boxRef:t,setIsLoading:r})=>{const o=f();l.useEffect(()=>{const n=i=>{i.target.closest("button")!==t.current&&a(!1)};return document.addEventListener("click",n),()=>{document.removeEventListener("click",n)}},[t,a]),l.useEffect(()=>{const n=i=>{i.code==="Escape"&&a(!1)};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[a]);const s=n=>{r(!0),o(Y({theme:n})).unwrap().finally(()=>{a(!1),r(!1)})};return e.jsx(q,{children:ps.map(n=>e.jsx(G,{children:e.jsxs(J,{onClick:()=>s(n),children:[" ",n]})},n))})},ms=({setIsLoading:a})=>{const[t,r]=l.useState(!1),o=l.useRef(),s=n=>{n.target.closest("ul")||r(!t)};return e.jsxs(Q,{children:[e.jsxs(X,{onClick:s,ref:o,children:[e.jsx(Z,{children:"Theme"}),!t&&e.jsx(g,{id:"chevron-down",size:16}),t&&e.jsx(g,{id:"chevron-up",size:16})]}),t&&e.jsx(xs,{boxRef:o,setIsOpenPopUp:r,setIsLoading:a})]})},js=["project","star","loading","puzzle-piece","container","lightning","colors","hexagon"],H=({boardId:a,handleCloseModal:t})=>{const r=m(ee),o=f(),s=m(c=>se(c,a)),{register:n,handleSubmit:i,formState:{errors:u}}=E({resolver:_(ie),defaultValues:{title:s==null?void 0:s.title,icon:s==null?void 0:s.icon,backgroundImage:s==null?void 0:s.backgroundImage},mode:"onChange"}),d=us.filter(c=>c.themes.includes(r)),h={width:28,height:28},j=c=>{a?o(ce({newBoardBody:c,id:a})).unwrap().then(()=>{t()}):o(le(c)).unwrap().then(()=>{t()})};return e.jsx(ae,{children:e.jsxs(te,{onSubmit:i(j),children:[e.jsx(ne,{children:s?"Edit board":"New board"}),e.jsx(re,{type:"text",autoFocus:!0,...n("title")}),e.jsxs(M,{children:[e.jsx(T,{children:"Icons"}),e.jsx($,{$gap:"3px",children:js.map(c=>e.jsxs(F,{children:[e.jsx(N,{type:"radio",...n("icon"),value:c}),e.jsx(g,{id:c,size:24,stroke:"rgba(255, 255, 255, 0.5)",fill:"rgba(0, 0, 0, 0)"})]},c))})]}),e.jsxs(M,{children:[e.jsx(T,{children:"Background"}),e.jsx($,{$width:"252px",$gap:"4px",children:d.map(c=>e.jsxs(F,{children:[e.jsx(N,{type:"radio",...n("backgroundImage"),value:c.key}),e.jsx(hs,{desktop:h,tablet:h,mobile:h,type:"image/png",pathKey:c.key,alt:c.alt,imageCategory:"boardIcons"})]},c.key))})]}),e.jsx(oe,{children:e.jsx(z,{title:s?"Edit":"Create",icon:!0,size:"large",style:{width:3340}})})]})})},gs=()=>{const a=m(de);return e.jsx(ue,{children:a.map(t=>e.jsx(Is,{icon:t.icon,title:t.title,id:t._id},t._id))})},Ss=({toggleModal:a})=>{const t=f(),r=O(),[o,s]=l.useState(!1),n=()=>{s(!0),t(me()).unwrap().then(()=>{r("/"),a(),S.warning("In order to use the application you must log in")}).catch(()=>{S.error("Oops... Something went wrong")}).finally(()=>{s(!1)})};return e.jsxs(he,{children:[e.jsx(pe,{children:"Are you sure you want to log out?"}),e.jsxs(xe,{children:[e.jsx(D,{type:"button",onClick:n,disabled:o,children:"Log out"}),e.jsx(D,{type:"button",onClick:()=>a(),children:"Cancel"})]})]})},fs=({toggleModal:a})=>{var u,d;const{register:t,handleSubmit:r,formState:{errors:o,dirtyFields:s}}=E({mode:"onChange",resolver:_(ke)}),n=f(),i=h=>{n(ye(h)).unwrap().then(()=>{a(),S.success("Your request has been successfully sent! Please, check your mail.")}).catch(()=>{S.error("An error occurred. Please try again later.")})};return e.jsx(je,{children:e.jsxs(ge,{onSubmit:r(i),children:[e.jsx(Se,{children:"Need help"}),e.jsxs(P,{children:[e.jsx(fe,{type:"text",name:"email",placeholder:"Email address",...t("email"),$hasError:!!o.email}),((u=o.email)==null?void 0:u.message)&&s&&e.jsx(R,{children:o.email.message})]}),e.jsxs(P,{className:"wrapperText",children:[e.jsx(ve,{type:"text",name:"message",placeholder:"Comment",...t("message"),$hasError:!!o.message}),((d=o.message)==null?void 0:d.message)&&s&&e.jsx(R,{children:o.message.message})]}),e.jsx(be,{type:"submit",children:"Send"})]})})},U=({className:a})=>{const[t,r]=k(),[o,s]=k(),[n,i]=k();return e.jsxs(e.Fragment,{children:[e.jsxs(we,{className:a,children:[e.jsxs(Ce,{to:"/",children:[e.jsx(y,{id:"logo",size:32,className:"logo"}),e.jsx(Ie,{children:"Task Pro"})]}),e.jsx(Be,{children:"My boards"}),e.jsxs(Le,{children:[e.jsx(Ee,{children:"Create a new board"}),e.jsx(_e,{type:"button",onClick:r,children:e.jsx(y,{id:"plus",size:20,className:"plus"})})]}),e.jsx(ze,{children:e.jsx(gs,{})}),e.jsxs(Me,{children:[e.jsxs(Te,{children:["If you need help with ",e.jsx("span",{children:"TaskPro"}),", check out our support resources or reach out to our customer support team."]}),e.jsxs($e,{onClick:s,children:[e.jsx(y,{id:"help-circle",size:20,className:"help-circle"}),"Need help?"]})]}),e.jsx(Fe,{children:e.jsxs(Ne,{type:"button",onClick:i,children:[e.jsx(y,{id:"login",size:32,className:"login"}),"Log out"]})})]}),t&&e.jsx(b,{toggleModal:r,children:e.jsx(H,{handleCloseModal:r})}),o&&e.jsx(b,{toggleModal:s,children:e.jsx(fs,{toggleModal:s})}),n&&e.jsx(b,{toggleModal:i,children:e.jsx(Ss,{toggleModal:i})})]})},vs=a=>new Promise(t=>{Oe.imageFileResizer(a,150,150,"JPEG",100,0,r=>{t(r)},"file")}),bs=({setAvatar:a})=>{const{avatarURL:t}=m(B),[r,o]=l.useState(t),s=l.useRef(null),n=()=>{s.current.click()},i=async u=>{const d=new FileReader,h=u.target.files[0];if(a(h),!h)return;const j=await vs(h);d.onload=c=>{const x=c.target.result;o(x)},d.readAsDataURL(j)};return e.jsxs(De,{children:[e.jsxs(Pe,{children:[r&&e.jsx("img",{src:r,alt:"avatar"}),!r&&e.jsx(g,{id:"user",size:48})]}),e.jsxs(Re,{children:[e.jsx(z,{size:"editProfile",type:"button",onClick:n}),e.jsx(Ae,{onChange:i,ref:s,type:"file",accept:"image/jpeg,image/png"})]})]})},ks=({register:a,current:t})=>{const[r,o]=l.useState(!1),s=()=>{o(!r)};return e.jsxs(We,{children:[e.jsx(w,{children:e.jsx(C,{...a("name"),defaultValue:t.name})}),e.jsx(w,{children:e.jsx(C,{...a("email"),defaultValue:t.email})}),e.jsxs(w,{children:[e.jsx(C,{...a("password"),placeholder:"password",type:r?"text":"password"}),e.jsx(He,{onClick:s,type:"button",className:r?"active":"",children:e.jsx(g,{id:"eye",size:18})})]})]})},ys=({handleCloseModal:a})=>{const[t,r]=l.useState(null),o=m(B),s=m(Ue),n=f(),{register:i,handleSubmit:u,formState:{errors:d}}=E({mode:"onChange",resolver:_(Ve)}),h=j=>{const{name:c,email:x,password:v}=j;if(!c&&!x&&!v&&!t)return;const p=new FormData;o.name!==c&&c&&p.append("name",c),o.email!==x&&x&&p.append("email",x),v&&p.append("password",v),t&&p.append("avatar",t),n(Ge(p)).unwrap().then(()=>{a()})};return e.jsxs(Ke,{onSubmit:u(h),children:[e.jsx(qe,{children:"Edit profile"}),e.jsx(bs,{setAvatar:r}),e.jsx(ks,{register:i,errors:d,current:o}),e.jsx(z,{title:"Send",icon:!1,isLoading:s})]})},ws=()=>{const{name:a,avatarURL:t}=m(B),[r,o]=k(),s=l.useRef(),n=u=>{u.target.closest("button")===s.current&&o()},i=()=>{o(!1)};return e.jsxs(Je,{onClick:n,ref:s,children:[e.jsx(Ye,{children:a}),e.jsxs(Qe,{children:[e.jsx("img",{src:t,alt:"avatar"}),!1]}),r&&e.jsx(b,{toggleModal:i,children:e.jsx(ys,{handleCloseModal:i})})]})},Cs=()=>{const[a,t]=l.useState(!1),[r,o]=l.useState(!1),s=l.useCallback(()=>{t(!a)},[a]),n=i=>{i.currentTarget===i.target&&s()};return l.useEffect(()=>{const i=u=>{const{code:d}=u;d==="Escape"&&s()};return document.addEventListener("keydown",i),()=>{document.removeEventListener("keydown",i)}},[s]),e.jsxs(Xe,{children:[a&&e.jsx(Ze,{onClick:n,children:e.jsx(U,{className:"sidebarHeader"})}),e.jsx(es,{onClick:s,children:e.jsx(g,{id:"menu"})}),e.jsx(ms,{setIsLoading:o}),e.jsx(ws,{}),r&&e.jsx(W,{})]})},Is=({id:a,title:t,icon:r})=>{const[o,s]=k(),n=f(),i=O(),{boardName:u}=ss(),d=m(as),[h,j]=ts("activeBoardId"),c=d._id===a,x=p=>{h!==a&&j(a),i(`/home/${p}`),n(cs(a))},v=p=>{n(ls(p)).unwrap().then(()=>{S.success(`The board "${u}" was deleted.`)}).catch(V=>{S.error(V.message)})};return e.jsxs(e.Fragment,{children:[e.jsxs(ns,{onClick:()=>x(t),$isActive:c,children:[e.jsxs(rs,{children:[e.jsx(I,{id:r,size:18,className:"project"}),e.jsx(os,{children:t})]}),c&&e.jsxs(is,{children:[e.jsx(A,{type:"button",onClick:s,"aria-label":"edit",children:e.jsx(I,{id:"pencil",size:16,className:"pencil"})}),e.jsx(A,{type:"button",onClick:()=>v(a),"aria-label":"delete",children:e.jsx(I,{id:"trash",size:16,className:"trash"})})]})]}),o&&e.jsx(b,{toggleModal:s,children:e.jsx(H,{boardId:a,handleCloseModal:s})})]})},Bs=L.div`
  display: flex;
  flex-direction: row;
`,Ls=L.div`
  width: 100%;
  height: 100vh;
  display: flex;
  flex-direction: column;

  @media screen and (min-width: 375px) {
    width: 375px;
  }
  @media screen and (min-width: 768px) {
    width: 768px;
  }
  @media screen and (min-width: 1440px) {
    width: 100%;
  }
`;L.div`
  @media screen and (max-width: 1440px) {
    display: none;
  }
`;const Ts=()=>e.jsxs(Bs,{children:[e.jsx(U,{className:"sidebarHome"}),e.jsxs(Ls,{children:[e.jsx(Cs,{}),e.jsx(l.Suspense,{fallback:e.jsx(W,{}),children:e.jsx(ds,{})})]})]});export{Ts as default};

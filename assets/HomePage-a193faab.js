import{t as G,b as v,r as d,j as e,S as J,f as Y,g as Q,h as X,i as Z,k as ee,m as se,I as f,n as j,s as L,o as ae,p as te,q as ne,v as re,R as oe,w as ie,x as C,y as I,z as ce,A as le,C as de,D as ue,E as he,F as pe,G as xe,H as me,J as je,M as k,K as E,O as ge,P as Se,Q as fe,T as ve,U as ke,V as ye,W as T,X as F,Y as N,Z as D,_ as P,$ as we,a0 as be,a1 as Ce,a2 as Ie,a3 as Be,a4 as U,a5 as Le,a6 as Ee,a7 as _e,a8 as $e,a9 as ze,aa as R,ab as Me,B as S,ac as Te,ad as Fe,ae as Ne,af as A,ag as De,ah as O,ai as Pe,aj as Re,ak as Ae,al as Oe,am as We,an as He,ao as w,ap as Ue,aq as Ve,ar as Ke,as as qe,at as Ge,au as Je,av as Ye,aw as Qe,ax as Xe,ay as Ze,az as es,aA as ss,aB as as,aC as ts,aD as V,e as ns,aE as rs,aF as os,aG as B,aH as is,aI as cs,aJ as W,aK as ls,aL as ds,u as _,aM as us}from"./index-4c5f1c7f.js";import{u as y}from"./useModal-b1f862ea.js";import{B as $,u as z,o as M}from"./yup-a9f40523.js";import{b as hs,I as ps}from"./Image-f5cf43a8.js";import"./index-0e05dea9.js";const xs=Object.keys(G),ms=({setIsOpenPopUp:s,boxRef:a,setIsLoading:r})=>{const o=v();d.useEffect(()=>{const t=i=>{i.target.closest("button")!==a.current&&s(!1)};return document.addEventListener("click",t),()=>{document.removeEventListener("click",t)}},[a,s]),d.useEffect(()=>{const t=i=>{i.code==="Escape"&&s(!1)};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[s]);const n=t=>{r(!0),o(X({theme:t})).unwrap().finally(()=>{s(!1),r(!1)})};return e.jsx(J,{children:xs.map(t=>e.jsx(Y,{children:e.jsxs(Q,{onClick:()=>n(t),children:[" ",t]})},t))})},js=({setIsLoading:s})=>{const[a,r]=d.useState(!1),o=d.useRef(),n=t=>{t.target.closest("ul")||r(!a)};return e.jsxs(Z,{children:[e.jsxs(ee,{onClick:n,ref:o,children:[e.jsx(se,{children:"Theme"}),!a&&e.jsx(f,{id:"chevron-down",size:16}),a&&e.jsx(f,{id:"chevron-up",size:16})]}),a&&e.jsx(ms,{boxRef:o,setIsOpenPopUp:r,setIsLoading:s})]})},gs=s=>new Promise(a=>{oe.imageFileResizer(s,150,150,"JPEG",100,0,r=>{a(r)},"file")}),Ss=({setAvatar:s})=>{const{avatarURL:a}=j(L),[r,o]=d.useState(a),n=d.useRef(null),t=()=>{n.current.click()},i=async l=>{const u=new FileReader,h=l.target.files[0];if(s(h),!h)return;const g=await gs(h);u.onload=p=>{const x=p.target.result;o(x)},u.readAsDataURL(g)};return e.jsxs(ae,{children:[e.jsxs(te,{children:[r&&e.jsx("img",{src:r,alt:"avatar"}),!r&&e.jsx(f,{id:"user",size:48})]}),e.jsxs(ne,{children:[e.jsx($,{size:"editProfile",type:"button",onClick:t}),e.jsx(re,{onChange:i,ref:n,type:"file",accept:"image/jpeg,image/png"})]})]})},fs=({register:s,current:a})=>{const[r,o]=d.useState(!1),n=()=>{o(!r)};return e.jsxs(ie,{children:[e.jsx(C,{children:e.jsx(I,{...s("name"),defaultValue:a.name})}),e.jsx(C,{children:e.jsx(I,{...s("email"),defaultValue:a.email})}),e.jsxs(C,{children:[e.jsx(I,{...s("password"),placeholder:"password",type:r?"text":"password"}),e.jsx(ce,{onClick:n,type:"button",className:r?"active":"",children:e.jsx(f,{id:"eye",size:18})})]})]})},vs=({handleCloseModal:s})=>{const[a,r]=d.useState(null),o=j(L),n=j(le),t=v(),{register:i,handleSubmit:l,formState:{errors:u}}=z({mode:"onChange",resolver:M(de)}),h=g=>{const{name:p,email:x,password:c}=g;if(!p&&!x&&!c&&!a)return;const m=new FormData;o.name!==p&&p&&m.append("name",p),o.email!==x&&x&&m.append("email",x),c&&m.append("password",c),a&&m.append("avatar",a),t(pe(m)).unwrap().then(()=>{s()})};return e.jsxs(ue,{onSubmit:l(h),children:[e.jsx(he,{children:"Edit profile"}),e.jsx(Ss,{setAvatar:r}),e.jsx(fs,{register:i,errors:u,current:o}),e.jsx($,{title:"Send",icon:!1,isLoading:n})]})},ks=()=>{const{name:s,avatarURL:a}=j(L),[r,o]=y(),n=d.useRef(),t=l=>{l.target.closest("button")===n.current&&o()},i=()=>{o(!1)};return e.jsxs(xe,{onClick:t,ref:n,children:[e.jsx(me,{children:s}),e.jsxs(je,{children:[a&&e.jsx("img",{src:a,alt:"avatar"}),!a&&e.jsx(f,{id:"user",size:32})]}),r&&e.jsx(k,{toggleModal:i,children:e.jsx(vs,{handleCloseModal:i})})]})},H=["project","star","loading","puzzle-piece","container","lightning","colors","hexagon"],K=({boardId:s,handleCloseModal:a})=>{var x;const r=E(),o=j(ge),n=v(),t=j(c=>Se(c,s)),i=hs.filter(c=>c.themes.includes(o)),{register:l,handleSubmit:u,formState:{errors:h}}=z({resolver:M(be),defaultValues:{title:t==null?void 0:t.title,icon:(t==null?void 0:t.icon)||H[0],backgroundImage:(t==null?void 0:t.backgroundImage)||i[0].key},mode:"onChange"}),g={width:28,height:28},p=c=>{s?n(Ce({newBoardBody:c,id:s})).unwrap().then(()=>{r(`/home/${c.title}`),a()}):n(Ie(c)).unwrap().then(()=>{r(`/home/${c.title}`),a()})};return e.jsx(fe,{children:e.jsxs(ve,{onSubmit:u(p),children:[e.jsx(ke,{children:t?"Edit board":"New board"}),e.jsx(ye,{type:"text",autoFocus:!0,...l("title"),placeholder:"Title"}),((x=h.title)==null?void 0:x.message)&&e.jsx("div",{children:h.title.message}),e.jsxs(T,{children:[e.jsx(F,{children:"Icons"}),e.jsx(N,{$gap:"11px",children:H.map(c=>e.jsxs(D,{children:[e.jsx(P,{type:"radio",...l("icon"),value:c}),e.jsx(f,{id:c,size:15})]},c))})]}),e.jsxs(T,{children:[e.jsx(F,{children:"Background"}),e.jsx(N,{$width:"252px",$gap:"4px",children:i.map(c=>e.jsxs(D,{children:[e.jsx(P,{type:"radio",...l("backgroundImage"),value:c.key}),e.jsx(ps,{desktop:g,tablet:g,mobile:g,type:"image/png",pathKey:c.key,alt:c.alt,imageCategory:"boardIcons"})]},c.key))})]}),e.jsx(we,{children:e.jsx($,{title:t?"Edit":"Create",icon:!0,size:"large",style:{width:3340}})})]})})},ys=({toggleSidebar:s})=>{const a=j(Be),r=j(U),[,o]=Le("activeBoardId",r==null?void 0:r._id);return e.jsx(Ee,{children:a.map(n=>e.jsx(Bs,{icon:n.icon,title:n.title,id:n._id,setActiveBoardId:o,toggleSidebar:s},n._id))})},ws=({toggleModal:s})=>{const a=v(),r=E(),[o,n]=d.useState(!1),t=()=>{n(!0),a(Me()).unwrap().then(()=>{r("/"),s(),S.warning("In order to use the application you must log in")}).catch(()=>{S.error("Oops... Something went wrong")}).finally(()=>{n(!1)})};return e.jsxs(_e,{children:[e.jsx($e,{children:"Are you sure you want to log out?"}),e.jsxs(ze,{children:[e.jsx(R,{type:"button",onClick:t,disabled:o,children:"Log out"}),e.jsx(R,{type:"button",onClick:()=>s(),children:"Cancel"})]})]})},bs=({toggleModal:s})=>{var l,u;const{register:a,handleSubmit:r,formState:{errors:o,dirtyFields:n}}=z({mode:"onChange",resolver:M(Ae)}),t=v(),i=h=>{t(Oe(h)).unwrap().then(()=>{s(),S.success("Your request has been successfully sent! Please, check your mail.")}).catch(()=>{S.error("An error occurred. Please try again later.")})};return e.jsx(Te,{children:e.jsxs(Fe,{onSubmit:r(i),children:[e.jsx(Ne,{children:"Need help"}),e.jsxs(A,{children:[e.jsx(De,{type:"text",name:"email",placeholder:"Email address",...a("email"),$hasError:!!o.email}),((l=o.email)==null?void 0:l.message)&&n&&e.jsx(O,{children:o.email.message})]}),e.jsxs(A,{className:"wrapperText",children:[e.jsx(Pe,{type:"text",name:"message",placeholder:"Comment",...a("message"),$hasError:!!o.message}),((u=o.message)==null?void 0:u.message)&&n&&e.jsx(O,{children:o.message.message})]}),e.jsx(Re,{type:"submit",children:"Send"})]})})},q=({className:s,toggleSidebar:a})=>{const[r,o]=y(),[n,t]=y(),[i,l]=y();return e.jsxs(e.Fragment,{children:[e.jsxs(We,{className:s,children:[e.jsxs(He,{to:"/",children:[e.jsx(w,{id:"logo",size:32,className:"logo"}),e.jsx(Ue,{children:"Task Pro"})]}),e.jsx(Ve,{children:"My boards"}),e.jsxs(Ke,{children:[e.jsx(qe,{children:"Create a new board"}),e.jsx(Ge,{type:"button",onClick:o,children:e.jsx(w,{id:"plus",size:20,className:"plus"})})]}),e.jsx(Je,{children:e.jsx(ys,{toggleSidebar:a})}),e.jsxs(Ye,{children:[e.jsxs(Qe,{children:["If you need help with ",e.jsx("span",{children:"TaskPro"}),", check out our support resources or reach out to our customer support team."]}),e.jsxs(Xe,{onClick:t,children:[e.jsx(w,{id:"help-circle",size:20,className:"help-circle"}),"Need help?"]})]}),e.jsx(Ze,{children:e.jsxs(es,{type:"button",onClick:l,children:[e.jsx(w,{id:"login",size:32,className:"login"}),"Log out"]})})]}),r&&e.jsx(k,{toggleModal:o,children:e.jsx(K,{handleCloseModal:o})}),n&&e.jsx(k,{toggleModal:t,children:e.jsx(bs,{toggleModal:t})}),i&&e.jsx(k,{toggleModal:l,children:e.jsx(ws,{toggleModal:l})})]})},Cs=({handleBackdropClick:s,toggleSidebar:a})=>(d.useEffect(()=>{const r=o=>{const{code:n}=o;n==="Escape"&&a()};return document.addEventListener("keydown",r),()=>{document.removeEventListener("keydown",r)}},[a]),e.jsx(ss,{onClick:s,children:e.jsx(q,{className:"sidebarHeader",toggleSidebar:a})})),Is=()=>{const[s,a]=d.useState(!1),[r,o]=d.useState(!1),n=d.useCallback(()=>{a(!s)},[s]),t=i=>{i.currentTarget===i.target&&n()};return e.jsxs(as,{children:[s&&e.jsx(Cs,{handleBackdropClick:t,toggleSidebar:n}),e.jsx(ts,{onClick:n,children:e.jsx(f,{id:"menu"})}),e.jsx(js,{setIsLoading:o}),e.jsx(ks,{}),r&&e.jsx(V,{})]})},Bs=({id:s,title:a,icon:r,setActiveBoardId:o,toggleSidebar:n=!1})=>{const[t,i]=y(),l=v(),u=E(),{boardName:h}=ns(),p=j(U)._id===s,x=m=>{l(ls(s)).unwrap().then(()=>{o(s),u(`/home/${m}`),n&&n()}).catch(b=>S.error(b.message))},c=m=>{l(ds(m)).unwrap().then(()=>{S.success(`The board "${h}" was deleted.`),n&&n()}).catch(b=>{S.error(b.message)})};return e.jsxs(e.Fragment,{children:[e.jsxs(rs,{onClick:()=>x(a),$isActive:p,children:[e.jsxs(os,{children:[e.jsx(B,{id:r,size:18,className:"project"}),e.jsx(is,{children:a})]}),p&&e.jsxs(cs,{children:[e.jsx(W,{type:"button",onClick:i,"aria-label":"edit",children:e.jsx(B,{id:"pencil",size:16,className:"pencil"})}),e.jsx(W,{type:"button",onClick:()=>c(s),"aria-label":"delete",children:e.jsx(B,{id:"trash",size:16,className:"trash"})})]})]}),t&&e.jsx(k,{toggleModal:i,children:e.jsx(K,{boardId:s,handleCloseModal:i})})]})},Ls=_.div`
  display: flex;
  flex-direction: row;
`,Es=_.div`
  width: 100%;
  height: 100vh;
  display: flex;
  flex-direction: column;

  @media screen and (min-width: 375px) {
    width: 375px;
  }
  @media screen and (min-width: 768px) {
    width: 768px;
  }
  @media screen and (min-width: 1440px) {
    width: 100%;
  }
`;_.div`
  @media screen and (max-width: 1440px) {
    display: none;
  }
`;const Fs=()=>e.jsxs(Ls,{children:[e.jsx(q,{className:"sidebarHome"}),e.jsxs(Es,{children:[e.jsx(Is,{}),e.jsx(d.Suspense,{fallback:e.jsx(V,{}),children:e.jsx(us,{})})]})]});export{Fs as default};

import{t as J,d as b,a as p,m as G,r as c,j as e,S as K,n as Y,p as Q,q as X,v as Z,w as ee,x as se,y as ae,I as g,z as B,A as te,C as ne,D as re,E as oe,R as ie,F as le,G as L,H as M,J as I,K as E,M as ce,s as D,g as F,o as $,O as de,P as ue,Q as he,T as pe,U as me,V as xe,W as je,X as f,Y as ge,Z as P,_ as Se,$ as fe,a0 as ve,a1 as we,a2 as N,a3 as ke,a4 as z,a5 as be,a6 as ye,a7 as Ce,a8 as Le,B as w,f as O,a9 as Me,aa as Ie,ab as C,ac as Ee,ad as _e,ae as Be,af as Ne,ag as ze,ah as Te,ai as De,aj as Fe,ak as $e,al as Pe,am as Oe,an as Ae,ao as Re,ap as Ue,aq as We,h as A,k as He,ar as Ve,as as qe,at as _,au as Je,av as Ge,aw as T,ax as Ke,ay as Ye,u as R,az as Qe}from"./index-96abb54a.js";import{u as v,B as U,C as W}from"./ConfirmationPopup-33058181.js";import{B as H}from"./Button-d5d42117.js";import"./Image-74e5cb8a.js";const Xe=Object.keys(J),Ze=({setIsOpenPopUp:n,boxRef:t,setIsLoading:s})=>{const a=b(),r=p(G);c.useEffect(()=>{const o=l=>{l.target.closest("button")!==t.current&&n(!1)};return document.addEventListener("click",o),()=>{document.removeEventListener("click",o)}},[t,n]),c.useEffect(()=>{const o=l=>{l.code==="Escape"&&n(!1)};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[n]);const i=o=>{s(!0),a(Z({theme:o})).unwrap().finally(()=>{n(!1),s(!1)})};return e.jsx(K,{children:Xe.map(o=>e.jsx(Y,{children:e.jsx(Q,{onClick:()=>i(o),children:e.jsx(X,{className:r===o&&"active",children:o})})},o))})},es=({setIsLoading:n})=>{const[t,s]=c.useState(!1),a=c.useRef(),r=i=>{i.target.closest("ul")||s(!t)};return e.jsxs(ee,{children:[e.jsxs(se,{onClick:r,ref:a,children:[e.jsx(ae,{children:"Theme"}),!t&&e.jsx(g,{id:"chevron-down",size:16,pointerEvents:"none"}),t&&e.jsx(g,{id:"chevron-up",size:16,pointerEvents:"none"})]}),t&&e.jsx(Ze,{boxRef:a,setIsOpenPopUp:s,setIsLoading:n})]})},ss=n=>new Promise(t=>{ie.imageFileResizer(n,150,150,"JPEG",100,0,s=>{t(s)},"file")}),as=({setAvatar:n})=>{const{avatarURL:t}=p(B),[s,a]=c.useState(t),r=c.useRef(null),i=()=>{r.current.click()},o=async l=>{const d=new FileReader,u=l.target.files[0];if(n(u),!u)return;const m=await ss(u);d.onload=x=>{const h=x.target.result;a(h)},d.readAsDataURL(m)};return e.jsxs(te,{children:[e.jsxs(ne,{children:[s&&e.jsx("img",{src:s,alt:"avatar"}),!s&&e.jsx(g,{id:"user",size:48})]}),e.jsxs(re,{children:[e.jsx(H,{size:"editProfile",type:"button",onClick:i}),e.jsx(oe,{onChange:o,ref:r,type:"file",accept:"image/jpeg,image/png"})]})]})},ts=({register:n,current:t,errors:s})=>{const[a,r]=c.useState(!1),i=()=>{r(!a)};return e.jsxs(le,{children:[e.jsxs(L,{children:[e.jsx(M,{children:e.jsx(I,{...n("name"),defaultValue:t.name,className:s.name?"has-error":"",$hasError:!!s.name})}),s.name&&e.jsx(E,{children:s.name.message})]}),e.jsxs(L,{children:[e.jsx(M,{children:e.jsx(I,{...n("email"),defaultValue:t.email,className:s.email?"has-error":"",$hasError:!!s.email})}),s.email&&e.jsx(E,{children:s.email.message})]}),e.jsxs(L,{children:[e.jsxs(M,{children:[e.jsx(I,{...n("password"),placeholder:"password",className:s.password?"has-error":"",type:a?"text":"password",$hasError:!!s.password}),e.jsx(ce,{onClick:i,type:"button",className:a?"active":"",children:a?e.jsx(g,{id:"eye",className:"icon",size:"18"}):e.jsx(g,{id:"eye-off",className:"icon",size:"18"})})]}),s.password&&e.jsx(E,{children:s.password.message})]})]})},ns=({handleCloseModal:n})=>{const[t,s]=c.useState(null),a=p(B),r=p(D),i=b(),{register:o,handleSubmit:l,formState:{errors:d,dirtyFields:u}}=F({mode:"onChange",resolver:$(de),shouldUnregister:!0}),m=x=>{const{name:h,email:k,password:S}=x;if(!h&&!k&&!S&&!t)return;const j=new FormData;a.name!==h&&h&&j.append("name",h),a.email!==k&&k&&j.append("email",k),S&&j.append("password",S),t&&j.append("avatar",t),i(pe(j)).unwrap().then(()=>{n()})};return e.jsxs(ue,{onSubmit:l(m),children:[e.jsx(he,{children:"Edit  profile"}),e.jsx(as,{setAvatar:s}),e.jsx(ts,{register:o,errors:d,current:a,dirtyFields:u}),e.jsx(H,{title:"Send",icon:!1,isLoading:r})]})},rs=()=>{const{name:n,avatarURL:t}=p(B),[s,a]=v(),r=c.useRef(),i=l=>{l.target.closest("button")===r.current&&a()},o=()=>{a(!1)};return e.jsxs(me,{onClick:i,ref:r,children:[e.jsx(xe,{children:n}),e.jsxs(je,{children:[t&&e.jsx("img",{src:t,alt:"avatar"}),!t&&e.jsx(g,{id:"user",size:32})]}),s&&e.jsx(f,{toggleModal:o,children:e.jsx(ns,{handleCloseModal:o})})]})},os=({toggleSidebar:n})=>{const t=p(ge),s=p(P),[,a]=Se("activeBoardId",s==null?void 0:s._id);return e.jsx(fe,{children:t.map(r=>e.jsx(ds,{icon:r.icon,title:r.title,id:r._id,setActiveBoardId:a,toggleSidebar:n},r._id))})},is=({toggleModal:n})=>{var l,d;const{register:t,handleSubmit:s,formState:{errors:a,dirtyFields:r}}=F({mode:"onChange",resolver:$(Ce)}),i=b(),o=u=>{i(Le(u)).unwrap().then(()=>{n(),w.success("Your request has been successfully sent! Please, check your mail.")}).catch(()=>{w.error("An error occurred. Please try again later.")})};return e.jsx(e.Fragment,{children:e.jsxs(ve,{onSubmit:s(o),children:[e.jsx(we,{children:"Need help"}),e.jsxs(N,{children:[e.jsx(ke,{type:"text",name:"email",placeholder:"Email address",...t("email"),$hasError:!!a.email}),((l=a.email)==null?void 0:l.message)&&r&&e.jsxs(z,{children:[a.email.message," "]})]}),e.jsxs(N,{className:"wrapperText",children:[e.jsx(be,{type:"text",name:"message",placeholder:"Comment",...t("message"),$hasError:!!a.message}),((d=a.message)==null?void 0:d.message)&&r&&e.jsx(z,{children:a.message.message})]}),e.jsx(ye,{type:"submit",children:"Send"})]})})},V=({className:n,toggleSidebar:t})=>{const[s,a]=v(),[r,i]=v(),[o,l]=v(),d=p(D),u=b(),m=O(),x=()=>{u(Ae()).unwrap().then(()=>{m("/"),a(),w.warning("In order to use the application you must log in.")}).catch(()=>{w.error("Sorry, something went wrong. Please try again later.")})};return e.jsxs(e.Fragment,{children:[e.jsxs(Me,{className:n,children:[e.jsxs(Ie,{to:"/",children:[e.jsx(C,{id:"logo",size:32,className:"logo"}),e.jsx(Ee,{children:"Task Pro"})]}),e.jsx(_e,{children:"My boards"}),e.jsxs(Be,{children:[e.jsx(Ne,{children:"Create a new board"}),e.jsx(ze,{type:"button",onClick:a,children:e.jsx(C,{id:"plus",size:20,className:"plus"})})]}),e.jsx(Te,{children:e.jsx(os,{toggleSidebar:t})}),e.jsxs(De,{children:[e.jsxs(Fe,{children:["If you need help with ",e.jsx("span",{children:"TaskPro"}),", check out our support resources or reach out to our customer support team."]}),e.jsxs($e,{onClick:i,children:[e.jsx(C,{id:"help-circle",size:20,className:"help-circle"}),"Need help?"]})]}),e.jsx(Pe,{children:e.jsxs(Oe,{type:"button",onClick:l,children:[e.jsx(C,{id:"login",size:32,className:"login"}),"Log out"]})})]}),s&&e.jsx(f,{toggleModal:a,children:e.jsx(U,{handleCloseModal:a})}),r&&e.jsx(f,{toggleModal:i,children:e.jsx(is,{toggleModal:i})}),o&&e.jsx(f,{toggleModal:l,children:e.jsx(W,{closeModal:l,approveModal:x,logout:!0,action:"log out",isLoading:d})})]})},ls=({handleBackdropClick:n,toggleSidebar:t})=>(c.useEffect(()=>{const s=a=>{const{code:r}=a;r==="Escape"&&t()};return document.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s)}},[t]),e.jsx(Re,{onClick:n,children:e.jsx(V,{className:"sidebarHeader",toggleSidebar:t})})),cs=()=>{const[n,t]=c.useState(!1),[s,a]=c.useState(!1),r=c.useCallback(()=>{t(!n)},[n]),i=o=>{o.currentTarget===o.target&&r()};return e.jsxs(Ue,{children:[n&&e.jsx(ls,{handleBackdropClick:i,toggleSidebar:r}),e.jsx(We,{onClick:r,children:e.jsx(g,{id:"menu"})}),e.jsx(es,{setIsLoading:a}),e.jsx(rs,{}),s&&e.jsx(A,{})]})},ds=({id:n,title:t,icon:s,toggleSidebar:a=!1})=>{const[r,i]=v(),[o,l]=v(),[d,u]=c.useState(!1),m=b(),x=O(),{boardName:h}=He(),S=p(P)._id===n,j=y=>{y!==h&&(x(`/home/${y}`),m(Ke(n)),a&&a(),localStorage.setItem("activeBoardId",JSON.stringify(n)))},q=()=>{u(!0),m(Ye(n)).unwrap().then(()=>{localStorage.removeItem("activeBoardId"),w.success(`The board "${h}" was deleted.`),x("/home"),a&&a()}).catch(y=>{w.error(y.message)}).finally(()=>{u(!1)})};return e.jsxs(e.Fragment,{children:[e.jsxs(Ve,{onClick:()=>j(t),$isActive:S,children:[e.jsxs(qe,{children:[e.jsx(_,{id:s,size:18,className:"project"}),e.jsx(Je,{children:t})]}),S&&e.jsxs(Ge,{children:[e.jsx(T,{type:"button",onClick:i,"aria-label":"edit",children:e.jsx(_,{id:"pencil",size:16,className:"pencil"})}),e.jsx(T,{type:"button",onClick:l,"aria-label":"delete",children:e.jsx(_,{id:"trash",size:16,className:"trash"})})]})]}),r&&e.jsx(f,{toggleModal:i,children:e.jsx(U,{boardId:n,handleCloseModal:i})}),o&&e.jsx(f,{toggleModal:l,children:e.jsx(W,{closeModal:l,approveModal:q,isLoading:d,action:`remove ${t} board`})})]})},us=R.div`
  display: flex;
  flex-direction: row;
`,hs=R.div`
  width: 100vw;
  height: 100vh;
  display: flex;
  flex-direction: column;
`,gs=()=>e.jsxs(us,{children:[e.jsx(V,{className:"sidebarHome"}),e.jsxs(hs,{children:[e.jsx(cs,{}),e.jsx(c.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(Qe,{})})]})]});export{gs as default};

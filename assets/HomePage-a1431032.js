import{t as q,b as v,r as d,j as e,S as G,f as J,g as Y,h as Q,i as X,k as Z,m as ee,I as f,n as B,o as g,s as se,p as ae,q as te,v as ne,w as re,x as oe,y as z,z as M,A as F,C as N,D,E as ie,F as ce,G as le,H as de,J as ue,K as H,M as he,O as pe,P as xe,Q as me,R as je,T as P,U as ge,B as S,V as Se,W as fe,X as ve,Y as R,Z as be,_ as A,$ as ke,a0 as ye,a1 as we,a2 as Ce,a3 as Ie,a4 as Be,a5 as y,a6 as Le,a7 as Ee,a8 as _e,a9 as $e,aa as Te,ab as ze,ac as Me,ad as Fe,ae as Ne,af as De,ag as Pe,ah as b,ai as L,aj as Re,ak as Ae,al as Oe,am as We,an as He,ao as Ue,ap as w,aq as C,ar as Ve,as as Ke,at as qe,au as Ge,av as Je,aw as Ye,ax as Qe,ay as Xe,az as Ze,aA as es,aB as ss,aC as as,aD as U,e as ts,aE as ns,aF as rs,aG as I,aH as os,aI as is,aJ as O,aK as cs,aL as ls,u as E,aM as ds}from"./index-78fa5a38.js";import{u as k}from"./useModal-ff36333d.js";import{u as _,o as $,B as T}from"./yup-dfacfd40.js";import{b as us,I as hs}from"./Image-8eda69fa.js";import"./index-0e05dea9.js";const ps=Object.keys(q),xs=({setIsOpenPopUp:a,boxRef:t,setIsLoading:r})=>{const n=v();d.useEffect(()=>{const s=i=>{i.target.closest("button")!==t.current&&a(!1)};return document.addEventListener("click",s),()=>{document.removeEventListener("click",s)}},[t,a]),d.useEffect(()=>{const s=i=>{i.code==="Escape"&&a(!1)};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}},[a]);const o=s=>{r(!0),n(Q({theme:s})).unwrap().finally(()=>{a(!1),r(!1)})};return e.jsx(G,{children:ps.map(s=>e.jsx(J,{children:e.jsxs(Y,{onClick:()=>o(s),children:[" ",s]})},s))})},ms=({setIsLoading:a})=>{const[t,r]=d.useState(!1),n=d.useRef(),o=s=>{s.target.closest("ul")||r(!t)};return e.jsxs(X,{children:[e.jsxs(Z,{onClick:o,ref:n,children:[e.jsx(ee,{children:"Theme"}),!t&&e.jsx(f,{id:"chevron-down",size:16}),t&&e.jsx(f,{id:"chevron-up",size:16})]}),t&&e.jsx(xs,{boxRef:n,setIsOpenPopUp:r,setIsLoading:a})]})},W=["project","star","loading","puzzle-piece","container","lightning","colors","hexagon"],V=({boardId:a,handleCloseModal:t})=>{var p;const r=B(),n=g(se),o=v(),s=g(c=>ae(c,a)),i=us.filter(c=>c.themes.includes(n)),{register:l,handleSubmit:u,formState:{errors:h}}=_({resolver:$(ce),defaultValues:{title:s==null?void 0:s.title,icon:(s==null?void 0:s.icon)||W[0],backgroundImage:(s==null?void 0:s.backgroundImage)||i[0].key},mode:"onChange"}),x={width:28,height:28},m=c=>{a?o(le({newBoardBody:c,id:a})).unwrap().then(()=>{r(`/home/${c.title}`),t()}):o(de(c)).unwrap().then(()=>{r(`/home/${c.title}`),t()})};return e.jsx(te,{children:e.jsxs(ne,{onSubmit:u(m),children:[e.jsx(re,{children:s?"Edit board":"New board"}),e.jsx(oe,{type:"text",autoFocus:!0,...l("title"),placeholder:"Title"}),((p=h.title)==null?void 0:p.message)&&e.jsx("div",{children:h.title.message}),e.jsxs(z,{children:[e.jsx(M,{children:"Icons"}),e.jsx(F,{$gap:"11px",children:W.map(c=>e.jsxs(N,{children:[e.jsx(D,{type:"radio",...l("icon"),value:c}),e.jsx(f,{id:c,size:15})]},c))})]}),e.jsxs(z,{children:[e.jsx(M,{children:"Background"}),e.jsx(F,{$width:"252px",$gap:"4px",children:i.map(c=>e.jsxs(N,{children:[e.jsx(D,{type:"radio",...l("backgroundImage"),value:c.key}),e.jsx(hs,{desktop:x,tablet:x,mobile:x,type:"image/png",pathKey:c.key,alt:c.alt,imageCategory:"boardIcons"})]},c.key))})]}),e.jsx(ie,{children:e.jsx(T,{title:s?"Edit":"Create",icon:!0,size:"large",style:{width:3340}})})]})})},js=()=>{const a=g(ue),t=g(H),[,r]=he("activeBoardId",t==null?void 0:t._id);return e.jsx(pe,{children:a.map(n=>e.jsx(Cs,{icon:n.icon,title:n.title,id:n._id,setActiveBoardId:r},n._id))})},gs=({toggleModal:a})=>{const t=v(),r=B(),[n,o]=d.useState(!1),s=()=>{o(!0),t(ge()).unwrap().then(()=>{r("/"),a(),S.warning("In order to use the application you must log in")}).catch(()=>{S.error("Oops... Something went wrong")}).finally(()=>{o(!1)})};return e.jsxs(xe,{children:[e.jsx(me,{children:"Are you sure you want to log out?"}),e.jsxs(je,{children:[e.jsx(P,{type:"button",onClick:s,disabled:n,children:"Log out"}),e.jsx(P,{type:"button",onClick:()=>a(),children:"Cancel"})]})]})},Ss=({toggleModal:a})=>{var l,u;const{register:t,handleSubmit:r,formState:{errors:n,dirtyFields:o}}=_({mode:"onChange",resolver:$(we)}),s=v(),i=h=>{s(Ce(h)).unwrap().then(()=>{a(),S.success("Your request has been successfully sent! Please, check your mail.")}).catch(()=>{S.error("An error occurred. Please try again later.")})};return e.jsx(Se,{children:e.jsxs(fe,{onSubmit:r(i),children:[e.jsx(ve,{children:"Need help"}),e.jsxs(R,{children:[e.jsx(be,{type:"text",name:"email",placeholder:"Email address",...t("email"),$hasError:!!n.email}),((l=n.email)==null?void 0:l.message)&&o&&e.jsx(A,{children:n.email.message})]}),e.jsxs(R,{className:"wrapperText",children:[e.jsx(ke,{type:"text",name:"message",placeholder:"Comment",...t("message"),$hasError:!!n.message}),((u=n.message)==null?void 0:u.message)&&o&&e.jsx(A,{children:n.message.message})]}),e.jsx(ye,{type:"submit",children:"Send"})]})})},K=({className:a})=>{const[t,r]=k(),[n,o]=k(),[s,i]=k();return e.jsxs(e.Fragment,{children:[e.jsxs(Ie,{className:a,children:[e.jsxs(Be,{to:"/",children:[e.jsx(y,{id:"logo",size:32,className:"logo"}),e.jsx(Le,{children:"Task Pro"})]}),e.jsx(Ee,{children:"My boards"}),e.jsxs(_e,{children:[e.jsx($e,{children:"Create a new board"}),e.jsx(Te,{type:"button",onClick:r,children:e.jsx(y,{id:"plus",size:20,className:"plus"})})]}),e.jsx(ze,{children:e.jsx(js,{})}),e.jsxs(Me,{children:[e.jsxs(Fe,{children:["If you need help with ",e.jsx("span",{children:"TaskPro"}),", check out our support resources or reach out to our customer support team."]}),e.jsxs(Ne,{onClick:o,children:[e.jsx(y,{id:"help-circle",size:20,className:"help-circle"}),"Need help?"]})]}),e.jsx(De,{children:e.jsxs(Pe,{type:"button",onClick:i,children:[e.jsx(y,{id:"login",size:32,className:"login"}),"Log out"]})})]}),t&&e.jsx(b,{toggleModal:r,children:e.jsx(V,{handleCloseModal:r})}),n&&e.jsx(b,{toggleModal:o,children:e.jsx(Ss,{toggleModal:o})}),s&&e.jsx(b,{toggleModal:i,children:e.jsx(gs,{toggleModal:i})})]})},fs=a=>new Promise(t=>{He.imageFileResizer(a,150,150,"JPEG",100,0,r=>{t(r)},"file")}),vs=({setAvatar:a})=>{const{avatarURL:t}=g(L),[r,n]=d.useState(t),o=d.useRef(null),s=()=>{o.current.click()},i=async l=>{const u=new FileReader,h=l.target.files[0];if(a(h),!h)return;const x=await fs(h);u.onload=m=>{const p=m.target.result;n(p)},u.readAsDataURL(x)};return e.jsxs(Re,{children:[e.jsxs(Ae,{children:[r&&e.jsx("img",{src:r,alt:"avatar"}),!r&&e.jsx(f,{id:"user",size:48})]}),e.jsxs(Oe,{children:[e.jsx(T,{size:"editProfile",type:"button",onClick:s}),e.jsx(We,{onChange:i,ref:o,type:"file",accept:"image/jpeg,image/png"})]})]})},bs=({register:a,current:t})=>{const[r,n]=d.useState(!1),o=()=>{n(!r)};return e.jsxs(Ue,{children:[e.jsx(w,{children:e.jsx(C,{...a("name"),defaultValue:t.name})}),e.jsx(w,{children:e.jsx(C,{...a("email"),defaultValue:t.email})}),e.jsxs(w,{children:[e.jsx(C,{...a("password"),placeholder:"password",type:r?"text":"password"}),e.jsx(Ve,{onClick:o,type:"button",className:r?"active":"",children:e.jsx(f,{id:"eye",size:18})})]})]})},ks=({handleCloseModal:a})=>{const[t,r]=d.useState(null),n=g(L),o=g(Ke),s=v(),{register:i,handleSubmit:l,formState:{errors:u}}=_({mode:"onChange",resolver:$(qe)}),h=x=>{const{name:m,email:p,password:c}=x;if(!m&&!p&&!c&&!t)return;const j=new FormData;n.name!==m&&m&&j.append("name",m),n.email!==p&&p&&j.append("email",p),c&&j.append("password",c),t&&j.append("avatar",t),s(Ye(j)).unwrap().then(()=>{a()})};return e.jsxs(Ge,{onSubmit:l(h),children:[e.jsx(Je,{children:"Edit profile"}),e.jsx(vs,{setAvatar:r}),e.jsx(bs,{register:i,errors:u,current:n}),e.jsx(T,{title:"Send",icon:!1,isLoading:o})]})},ys=()=>{const{name:a,avatarURL:t}=g(L),[r,n]=k(),o=d.useRef(),s=l=>{l.target.closest("button")===o.current&&n()},i=()=>{n(!1)};return e.jsxs(Qe,{onClick:s,ref:o,children:[e.jsx(Xe,{children:a}),e.jsxs(Ze,{children:[e.jsx("img",{src:t,alt:"avatar"}),!1]}),r&&e.jsx(b,{toggleModal:i,children:e.jsx(ks,{handleCloseModal:i})})]})},ws=()=>{const[a,t]=d.useState(!1),[r,n]=d.useState(!1),o=d.useCallback(()=>{t(!a)},[a]),s=i=>{i.currentTarget===i.target&&o()};return d.useEffect(()=>{const i=l=>{const{code:u}=l;u==="Escape"&&o()};return document.addEventListener("keydown",i),()=>{document.removeEventListener("keydown",i)}},[o]),e.jsxs(es,{children:[a&&e.jsx(ss,{onClick:s,children:e.jsx(K,{className:"sidebarHeader"})}),e.jsx(as,{onClick:o,children:e.jsx(f,{id:"menu"})}),e.jsx(ms,{setIsLoading:n}),e.jsx(ys,{}),r&&e.jsx(U,{})]})},Cs=({id:a,title:t,icon:r,setActiveBoardId:n})=>{const[o,s]=k(),i=v(),l=B(),{boardName:u}=ts(),x=g(H)._id===a,m=c=>{i(cs(a)).unwrap().then(()=>{n(a),l(`/home/${c}`)}).catch(j=>S.error(j.message))},p=c=>{i(ls(c)).unwrap().then(()=>{S.success(`The board "${u}" was deleted.`)}).catch(j=>{S.error(j.message)})};return e.jsxs(e.Fragment,{children:[e.jsxs(ns,{onClick:()=>m(t),$isActive:x,children:[e.jsxs(rs,{children:[e.jsx(I,{id:r,size:18,className:"project"}),e.jsx(os,{children:t})]}),x&&e.jsxs(is,{children:[e.jsx(O,{type:"button",onClick:s,"aria-label":"edit",children:e.jsx(I,{id:"pencil",size:16,className:"pencil"})}),e.jsx(O,{type:"button",onClick:()=>p(a),"aria-label":"delete",children:e.jsx(I,{id:"trash",size:16,className:"trash"})})]})]}),o&&e.jsx(b,{toggleModal:s,children:e.jsx(V,{boardId:a,handleCloseModal:s})})]})},Is=E.div`
  display: flex;
  flex-direction: row;
`,Bs=E.div`
  width: 100%;
  height: 100vh;
  display: flex;
  flex-direction: column;

  @media screen and (min-width: 375px) {
    width: 375px;
  }
  @media screen and (min-width: 768px) {
    width: 768px;
  }
  @media screen and (min-width: 1440px) {
    width: 100%;
  }
`;E.div`
  @media screen and (max-width: 1440px) {
    display: none;
  }
`;const zs=()=>e.jsxs(Is,{children:[e.jsx(K,{className:"sidebarHome"}),e.jsxs(Bs,{children:[e.jsx(ws,{}),e.jsx(d.Suspense,{fallback:e.jsx(U,{}),children:e.jsx(ds,{})})]})]});export{zs as default};
